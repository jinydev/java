<!doctype html>
<html lang="ko">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- 기본 메타데이터 --><meta name="description" content="Jiny linux"><meta name="author" content="HojinLee"><!-- 제목 설정 --><title>Chapter 19. 네트워크 입출력</title>
  <meta name="title" content="Chapter 19. 네트워크 입출력" /><!-- 키워드 설정 --><!-- Open Graph 메타데이터 --><meta property="og:title" content="Chapter 19. 네트워크 입출력"><meta property="og:description" content="Jiny linux"><meta property="og:type" content="website"><meta property="og:locale" content="ko">
  <meta property="og:site_name" content="linux">
  <meta property="og:url" content="https://java.jiny.dev/part04/19/">

  <!-- Twitter 카드 메타데이터 --><meta name="twitter:card" content="summary"><meta property="twitter:title" content="Chapter 19. 네트워크 입출력"><!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Chapter 19. 네트워크 입출력" />
<meta name="author" content="Hojin" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="자바 언어를 통한 객체지향 프로그래밍의 이해와 실습" />
<meta property="og:description" content="자바 언어를 통한 객체지향 프로그래밍의 이해와 실습" />
<link rel="canonical" href="https://java.jiny.dev/part04/19/" />
<meta property="og:url" content="https://java.jiny.dev/part04/19/" />
<meta property="og:site_name" content="객체지향 자바 프로그래밍 (Object-Oriented Java Programming)" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Chapter 19. 네트워크 입출력" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Hojin"},"description":"자바 언어를 통한 객체지향 프로그래밍의 이해와 실습","headline":"Chapter 19. 네트워크 입출력","url":"https://java.jiny.dev/part04/19/"}</script>
<!-- End Jekyll SEO tag -->


  <link href="/assets/css/bootstrap.min.css" rel="stylesheet" />
  <link href="/assets/css/docs.css" rel="stylesheet" />
  <link href="/assets/css/highlight.css" rel="stylesheet" />

  <style>
    blockquote {
      border-left: solid 5px #dee2e6;
      padding: 5px 10px;
      background-color: #f8f9fa;
    }
  </style>

  <style>
    h1 a {
      text-decoration: none;
    }

    h2 a {
      text-decoration: none;
    }

    h3 a {
      text-decoration: none;
    }

    h4 a {
      text-decoration: none;
    }

    h5 a {
      text-decoration: none;
    }

    h6 a {
      text-decoration: none;
    }

    img {
      max-width: 100%;
      height: auto;
      vertical-align: top
    }

    strong a {
      text-decoration: none;
      color: inherit;
    }

    /* 스크롤바 커스텀 */
    /* 임의의 영역 생성 */
    .scrollBar {}

    /* 아래의 모든 코드는 영역::코드로 사용 */
    .scrollBar::-webkit-scrollbar {
      width: 7px;
      /* 스크롤바의 너비 */
    }

    .scrollBar::-webkit-scrollbar-thumb {
      height: 30%;
      /* 스크롤바의 길이 */
      background: #cccccc;
      /* 스크롤바의 색상 */

      border-radius: 5px;
    }

    .scrollBar::-webkit-scrollbar-track {
      background: rgba(33, 122, 244, .1);
      /*스크롤바 뒷 배경 색상*/
    }
  </style>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-R4VBPCT3CR"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-R4VBPCT3CR');
  </script>


</head>

<body>
  <header class="navbar navbar-expand-lg bd-navbar sticky-top">
    <nav class="container bd-gutter flex-wrap flex-lg-nowrap position-relative" aria-label="Main navigation">

      <!-- Mobile: Left Toggle (Browse) -->
      <div class="bd-navbar-toggle d-lg-none">
        <button class="navbar-toggler p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#bdSidebar"
          aria-controls="bdSidebar" aria-label="Toggle docs navigation">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="bi" fill="currentColor"
            viewBox="0 0 16 16">
            <path fill-rule="evenodd"
              d="M2.5 11.5A.5.5 0 0 1 3 11h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4A.5.5 0 0 1 3 7h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4A.5.5 0 0 1 3 3h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z">
            </path>
          </svg>
          <span class="d-none fs-6 pe-1">Browse</span>
        </button>
      </div>

      <!-- Brand: Desktop (Static), Mobile (Absolute Center) -->
      <a class="navbar-brand p-0 me-0 me-lg-2 ms-lg-0 d-none d-lg-inline-block" href="/" aria-label="jinydev">
        <svg width="32" height="26" viewBox="0 0 32 29" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M24.2746 5.33377C25.8486 7.33981 25.1183 11.1792 24.3961 13.0177C24.4028 13.0199 24.4094 13.0221 24.4161 13.0243L24.4013 13.0248L22.649 12.9082C22.649 12.9053 22.6488 12.9013 22.649 12.8993C22.9902 8.93373 22.5975 7.34575 22.2147 7.07677C17.6316 10.3896 13.5379 9.33658 12.2725 9.01111C11.928 8.9225 11.7932 8.88781 11.9152 9.00988C12.2872 9.38185 13.1336 9.82821 13.7371 10.1465H13.7372L13.7376 10.1467C13.8743 10.2188 13.9985 10.2843 14.1019 10.3409C9.12673 10.3984 7.12659 8.00279 6.53855 7.29846C6.47859 7.22664 6.4333 7.1724 6.40105 7.14015C6.11408 6.85318 4.49961 5.87252 3.99256 7.74227C3.50142 9.55335 3.81246 11.6775 3.97665 12.7988C3.99089 12.896 3.99257 12.8981 3.99257 12.9298L2.37635 13.0248L2.37213 13.0247C0.223493 8.05534 1.83854 5.26971 3.29536 4.2246C3.29536 1.78444 6.27428 -0.592359 10.0455 0.263262C14.8768 1.64043 16.3468 1.18409 18.0759 0.647278C18.774 0.430562 19.5143 0.200726 20.5351 0.073124C25.2219 -0.512739 26.7993 2.56612 27 4.16122C26.2141 3.70487 24.8556 4.73165 24.2746 5.33377ZM12.3374 1.5872C11.1225 1.16466 7.99257 0.717209 6.3478 2.41116C5.98397 2.78587 5.55554 3.48864 5.55554 3.48864C5.55554 3.48864 4.82665 4.81961 4.25622 4.24919C3.68579 3.67878 5.0168 1.96749 6.06259 1.46044C7.10838 0.953388 9.70703 0.0660505 12.3374 1.5872Z"
            fill="currentColor" />
          <path
            d="M10.078 13.5002H3.10601C2.2309 13.5002 1.52148 14.2097 1.52148 15.0848V18.3172C1.52148 19.1923 2.2309 19.9018 3.10601 19.9018H10.078C10.9531 19.9018 11.6625 19.1923 11.6625 18.3172V15.0848C11.6625 14.2097 10.9531 13.5002 10.078 13.5002Z"
            stroke="currentColor" stroke-width="1.26763" />
          <path
            d="M0.823513 14.6094H0.379847C0.187322 14.6094 0.03125 14.7654 0.03125 14.958V15.9721C0.03125 16.1646 0.187322 16.3207 0.379847 16.3207H0.823513C1.01604 16.3207 1.17211 16.1646 1.17211 15.9721V14.958C1.17211 14.7654 1.01604 14.6094 0.823513 14.6094Z"
            fill="currentColor" stroke="currentColor" stroke-width="0.0633813" />
          <path
            d="M16.7326 13.5002H23.7045C24.5796 13.5002 25.2891 14.2097 25.2891 15.0848V18.3172C25.2891 19.1923 24.5796 19.9018 23.7045 19.9018H16.7326C15.8575 19.9018 15.1481 19.1923 15.1481 18.3172V15.0848C15.1481 14.2097 15.8575 13.5002 16.7326 13.5002Z"
            stroke="currentColor" stroke-width="1.26763" />
          <path
            d="M25.9861 14.6094H26.4297C26.6222 14.6094 26.7783 14.7654 26.7783 14.958V15.9721C26.7783 16.1646 26.6222 16.3207 26.4297 16.3207H25.9861C25.7935 16.3207 25.6375 16.1646 25.6375 15.9721V14.958C25.6375 14.7654 25.7935 14.6094 25.9861 14.6094Z"
            fill="currentColor" stroke="currentColor" stroke-width="0.0633813" />
          <path
            d="M12.2954 15.5601H14.5137C14.7062 15.5601 14.8623 15.7161 14.8623 15.9087V16.9228C14.8623 17.1153 14.7062 17.2713 14.5137 17.2713H12.2954C12.1028 17.2713 11.9468 17.1153 11.9468 16.9228V15.9087C11.9468 15.7161 12.1028 15.5601 12.2954 15.5601Z"
            fill="currentColor" stroke="currentColor" stroke-width="0.0633813" />
          <path
            d="M9.93343 16.3937C9.93343 16.7087 9.76317 16.9641 9.55314 16.9641C9.34311 16.9641 9.17285 16.7087 9.17285 16.3937C9.17285 16.0786 9.34311 15.8232 9.55314 15.8232C9.76317 15.8232 9.93343 16.0786 9.93343 16.3937Z"
            fill="currentColor" />
          <path
            d="M16.9688 16.3937C16.9688 16.7087 17.139 16.9641 17.3491 16.9641C17.5591 16.9641 17.7293 16.7087 17.7293 16.3937C17.7293 16.0786 17.5591 15.8232 17.3491 15.8232C17.139 15.8232 16.9688 16.0786 16.9688 16.3937Z"
            fill="currentColor" />
          <path
            d="M14.2758 20.1016C13.642 20.6086 12.7863 20.3551 12.5645 20.1016C12.6278 20.4185 12.8687 20.8622 13.4518 20.8622C14.0349 20.8622 14.2441 20.3551 14.2758 20.1016Z"
            fill="currentColor" />
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M12.1312 22.411C12.1575 22.2914 12.2759 22.2157 12.3956 22.2421L14.6347 22.735C14.7544 22.7614 14.83 22.8797 14.8036 22.9994C14.7773 23.119 14.659 23.1947 14.5393 23.1683L12.3002 22.6753C12.1805 22.649 12.1049 22.5307 12.1312 22.411Z"
            fill="currentColor" />
          <path
            d="M13.4203 27.6754C9.00897 27.7261 5.77228 23.6613 4.70536 21.6225C4.54691 21.3197 4.42016 21.2739 4.32509 21.3373C4.17297 21.4387 4.28282 21.6437 4.32507 21.7493C4.85747 22.9916 5.58213 24.0416 5.87791 24.4113C4.83846 26.1353 4.49409 27.855 4.45183 28.4994C6.1758 26.8008 7.91668 26.8832 8.57162 27.1367C13.7055 29.7987 16.5577 27.929 18.1739 27.1367C19.4669 26.5029 21.4803 27.7388 22.3254 28.436C22.224 26.8642 21.3747 25.1402 20.9627 24.4747C21.6282 23.5873 22.1669 22.5099 22.4522 21.9711C22.6803 21.5401 22.6106 21.369 22.5472 21.3373C22.3951 21.2613 22.2092 21.4958 22.1353 21.6225C21.6599 22.4148 18.9345 27.6121 13.4203 27.6754Z"
            fill="currentColor" />
        </svg>
      </a>
      <a class="navbar-brand p-0 me-0 position-absolute top-50 start-50 translate-middle d-lg-none" href="/"
        aria-label="jinydev">
        <svg width="100" height="26" viewBox="0 0 112 29" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M24.2746 5.33377C25.8486 7.33981 25.1183 11.1792 24.3961 13.0177C24.4028 13.0199 24.4094 13.0221 24.4161 13.0243L24.4013 13.0248L22.649 12.9082C22.649 12.9053 22.6488 12.9013 22.649 12.8993C22.9902 8.93373 22.5975 7.34575 22.2147 7.07677C17.6316 10.3896 13.5379 9.33658 12.2725 9.01111C11.928 8.9225 11.7932 8.88781 11.9152 9.00988C12.2872 9.38185 13.1336 9.82821 13.7371 10.1465H13.7372L13.7376 10.1467C13.8743 10.2188 13.9985 10.2843 14.1019 10.3409C9.12673 10.3984 7.12659 8.00279 6.53855 7.29846C6.47859 7.22664 6.4333 7.1724 6.40105 7.14015C6.11408 6.85318 4.49961 5.87252 3.99256 7.74227C3.50142 9.55335 3.81246 11.6775 3.97665 12.7988C3.99089 12.896 3.99257 12.8981 3.99257 12.9298L2.37635 13.0248L2.37213 13.0247C0.223493 8.05534 1.83854 5.26971 3.29536 4.2246C3.29536 1.78444 6.27428 -0.592359 10.0455 0.263262C14.8768 1.64043 16.3468 1.18409 18.0759 0.647278C18.774 0.430562 19.5143 0.200726 20.5351 0.073124C25.2219 -0.512739 26.7993 2.56612 27 4.16122C26.2141 3.70487 24.8556 4.73165 24.2746 5.33377ZM12.3374 1.5872C11.1225 1.16466 7.99257 0.717209 6.3478 2.41116C5.98397 2.78587 5.55554 3.48864 5.55554 3.48864C5.55554 3.48864 4.82665 4.81961 4.25622 4.24919C3.68579 3.67878 5.0168 1.96749 6.06259 1.46044C7.10838 0.953388 9.70703 0.0660505 12.3374 1.5872Z"
            fill="currentColor" />
          <path
            d="M10.078 13.5002H3.10601C2.2309 13.5002 1.52148 14.2097 1.52148 15.0848V18.3172C1.52148 19.1923 2.2309 19.9018 3.10601 19.9018H10.078C10.9531 19.9018 11.6625 19.1923 11.6625 18.3172V15.0848C11.6625 14.2097 10.9531 13.5002 10.078 13.5002Z"
            stroke="currentColor" stroke-width="1.26763" />
          <path
            d="M0.823513 14.6094H0.379847C0.187322 14.6094 0.03125 14.7654 0.03125 14.958V15.9721C0.03125 16.1646 0.187322 16.3207 0.379847 16.3207H0.823513C1.01604 16.3207 1.17211 16.1646 1.17211 15.9721V14.958C1.17211 14.7654 1.01604 14.6094 0.823513 14.6094Z"
            fill="currentColor" stroke="currentColor" stroke-width="0.0633813" />
          <path
            d="M16.7326 13.5002H23.7045C24.5796 13.5002 25.2891 14.2097 25.2891 15.0848V18.3172C25.2891 19.1923 24.5796 19.9018 23.7045 19.9018H16.7326C15.8575 19.9018 15.1481 19.1923 15.1481 18.3172V15.0848C15.1481 14.2097 15.8575 13.5002 16.7326 13.5002Z"
            stroke="currentColor" stroke-width="1.26763" />
          <path
            d="M25.9861 14.6094H26.4297C26.6222 14.6094 26.7783 14.7654 26.7783 14.958V15.9721C26.7783 16.1646 26.6222 16.3207 26.4297 16.3207H25.9861C25.7935 16.3207 25.6375 16.1646 25.6375 15.9721V14.958C25.6375 14.7654 25.7935 14.6094 25.9861 14.6094Z"
            fill="currentColor" stroke="currentColor" stroke-width="0.0633813" />
          <path
            d="M12.2954 15.5601H14.5137C14.7062 15.5601 14.8623 15.7161 14.8623 15.9087V16.9228C14.8623 17.1153 14.7062 17.2713 14.5137 17.2713H12.2954C12.1028 17.2713 11.9468 17.1153 11.9468 16.9228V15.9087C11.9468 15.7161 12.1028 15.5601 12.2954 15.5601Z"
            fill="currentColor" stroke="currentColor" stroke-width="0.0633813" />
          <path
            d="M9.93343 16.3937C9.93343 16.7087 9.76317 16.9641 9.55314 16.9641C9.34311 16.9641 9.17285 16.7087 9.17285 16.3937C9.17285 16.0786 9.34311 15.8232 9.55314 15.8232C9.76317 15.8232 9.93343 16.0786 9.93343 16.3937Z"
            fill="currentColor" />
          <path
            d="M16.9688 16.3937C16.9688 16.7087 17.139 16.9641 17.3491 16.9641C17.5591 16.9641 17.7293 16.7087 17.7293 16.3937C17.7293 16.0786 17.5591 15.8232 17.3491 15.8232C17.139 15.8232 16.9688 16.0786 16.9688 16.3937Z"
            fill="currentColor" />
          <path
            d="M14.2758 20.1016C13.642 20.6086 12.7863 20.3551 12.5645 20.1016C12.6278 20.4185 12.8687 20.8622 13.4518 20.8622C14.0349 20.8622 14.2441 20.3551 14.2758 20.1016Z"
            fill="currentColor" />
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M12.1312 22.411C12.1575 22.2914 12.2759 22.2157 12.3956 22.2421L14.6347 22.735C14.7544 22.7614 14.83 22.8797 14.8036 22.9994C14.7773 23.119 14.659 23.1947 14.5393 23.1683L12.3002 22.6753C12.1805 22.649 12.1049 22.5307 12.1312 22.411Z"
            fill="currentColor" />
          <path
            d="M13.4203 27.6754C9.00897 27.7261 5.77228 23.6613 4.70536 21.6225C4.54691 21.3197 4.42016 21.2739 4.32509 21.3373C4.17297 21.4387 4.28282 21.6437 4.32507 21.7493C4.85747 22.9916 5.58213 24.0416 5.87791 24.4113C4.83846 26.1353 4.49409 27.855 4.45183 28.4994C6.1758 26.8008 7.91668 26.8832 8.57162 27.1367C13.7055 29.7987 16.5577 27.929 18.1739 27.1367C19.4669 26.5029 21.4803 27.7388 22.3254 28.436C22.224 26.8642 21.3747 25.1402 20.9627 24.4747C21.6282 23.5873 22.1669 22.5099 22.4522 21.9711C22.6803 21.5401 22.6106 21.369 22.5472 21.3373C22.3951 21.2613 22.2092 21.4958 22.1353 21.6225C21.6599 22.4148 18.9345 27.6121 13.4203 27.6754Z"
            fill="currentColor" />
          <text x="32" y="21" font-family="Arial, sans-serif" font-weight="bold" font-size="22"
            fill="currentColor">Jiny</text>
        </svg>
      </a>

      <!-- Mobile: Right Toggle (Menu) -->
      <div class="d-flex d-lg-none ms-auto">
        <button class="navbar-toggler p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#bdNavbar"
          aria-controls="bdNavbar" aria-label="Toggle navigation">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-grid"
            viewBox="0 0 16 16">
            <path
              d="M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5v-3zM2.5 2a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zM1 10.5A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z" />
          </svg>
        </button>
      </div>

      <!-- OffCanvas -->
      <div class="offcanvas-lg offcanvas-end flex-grow-1" tabindex="-1" id="bdNavbar"
        aria-labelledby="bdNavbarOffcanvasLabel" data-bs-scroll="true">
        <!-- OffCanver Header -->
        <div class="offcanvas-header px-4 pb-0">
          <h5 class="offcanvas-title text-white" id="bdNavbarOffcanvasLabel">Jiny</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"
            data-bs-target="#bdNavbar">
          </button>
        </div>

        <!-- OffCanver Body -->
        <div class="offcanvas-body p-4 pt-0 p-lg-0">
          <hr class="d-lg-none text-white-50">

          <ul class="navbar-nav flex-column flex-lg-row bd-navbar-nav">
            
            <li class="nav-item">
              <a class="nav-link py-2 px-0 px-lg-2" href="/part01/">자바 기초</a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link py-2 px-0 px-lg-2" href="/part02/">객체지향</a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link py-2 px-0 px-lg-2" href="/part03/">라이브러리</a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link py-2 px-0 px-lg-2" href="/part04/">데이터 I/O</a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link py-2 px-0 px-lg-2" href="/part05/">최신 자바</a>
            </li>
            
          </ul>

          <hr class="d-lg-none text-white-50">

          <ul class="navbar-nav flex-row flex-wrap ms-md-auto">
            <li class="nav-item col-6 col-lg-auto">
              <a class="nav-link py-2 px-0 px-lg-2" href="https://github.com/jinydev/datas" target="_blank"
                rel="noopener">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" class="navbar-nav-svg"
                  viewBox="0 0 512 499.36" role="img">
                  <title>GitHub</title>
                  <path fill="currentColor" fill-rule="evenodd"
                    d="M256 0C114.64 0 0 114.61 0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34 0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49 0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75 0 0 21.49-6.88 70.4 26.24a242.65 242.65 0 0 1 128.18 0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69 0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41 0 34.22-.31 61.83-.31 70.23 0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37 0 256 0z">
                  </path>
                </svg>
                <small class="d-lg-none ms-2">GitHub</small>
              </a>
            </li>

            <li class="nav-item py-2 py-lg-1 col-12 col-lg-auto">
              <div class="vr d-none d-lg-flex h-100 mx-lg-2 text-white"></div>
              <hr class="d-lg-none my-2 text-white-50">
            </li>

            <li class="nav-item col-6 col-lg-auto">
              <a class="nav-link py-2 px-0 px-lg-2" href="https://jiny.dev" aria-label="Home">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" class="navbar-nav-svg"
                  viewBox="0 0 16 16" role="img">
                  <title>Home</title>
                  <path fill="currentColor"
                    d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4H2.5z" />
                </svg>
                <small class="d-lg-none ms-2">Home</small>
              </a>
            </li>
          </ul>

        </div>
      </div>
    </nav>
  </header>

  <div class="container bd-gutter mt-3 my-md-4 bd-layout">
    <aside class="bd-sidebar scrollBar">
        <div class="offcanvas-lg offcanvas-start" tabindex="-1" id="bdSidebar"
            aria-labelledby="bdSidebarOffcanvasLabel">
            <div class="offcanvas-header border-bottom">
                <h5 class="offcanvas-title" id="bdSidebarOffcanvasLabel">학습목차</h5>
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"
                    data-bs-target="#bdSidebar"></button>
            </div>

            <div class="offcanvas-body">
                <!-- 네비게이션 -->
                <nav class="bd-links w-100" id="bd-docs-nav" aria-label="Docs navigation">
  <ul class="bd-links-nav list-unstyled mb-0 pb-3 pb-md-2 pe-lg-2">
    <li class="bd-links-group py-2">
      <strong class="bd-links-heading d-flex w-100 align-items-center fw-semibold">
        강의 목차
      </strong>
      <ul class="list-unstyled fw-normal pb-2 small">
        
        

        
        <li>
          
          
          
          <button
            class="bd-links-link bd-links-btn btn d-inline-flex align-items-center rounded border-0 collapsed w-100"
            data-bs-toggle="collapse" data-bs-target="#collapse-1"
            aria-expanded="false">
            18. 데이터 입출력
            <svg class="bi ms-auto" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor"
              xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd"
                d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z" />
            </svg>
          </button>
          <div class="collapse " id="collapse-1">
            <ul class="list-unstyled fw-normal pb-1 small ms-3">
              
              <li>
                <a href="/part04/18/"
                  class="bd-links-link d-inline-block rounded ">
                  18. 데이터 입출력
                </a>
              </li>
              
              <li>
                <a href="/part04/18/#181-입출력-스트림"
                  class="bd-links-link d-inline-block rounded ">
                  18.1 입출력 스트림
                </a>
              </li>
              
              <li>
                <a href="/part04/18/#182-바이트-출력-스트림"
                  class="bd-links-link d-inline-block rounded ">
                  18.2 바이트 출력 스트림
                </a>
              </li>
              
              <li>
                <a href="/part04/18/#183-바이트-입력-스트림"
                  class="bd-links-link d-inline-block rounded ">
                  18.3 바이트 입력 스트림
                </a>
              </li>
              
              <li>
                <a href="/part04/18/#184-문자-입출력-스트림"
                  class="bd-links-link d-inline-block rounded ">
                  18.4 문자 입출력 스트림
                </a>
              </li>
              
              <li>
                <a href="/part04/18/#185-보조-스트림"
                  class="bd-links-link d-inline-block rounded ">
                  18.5 보조 스트림
                </a>
              </li>
              
              <li>
                <a href="/part04/18/#186-문자-변환-스트림"
                  class="bd-links-link d-inline-block rounded ">
                  18.6 문자 변환 스트림
                </a>
              </li>
              
              <li>
                <a href="/part04/18/#187-성능-향상-스트림"
                  class="bd-links-link d-inline-block rounded ">
                  18.7 성능 향상 스트림
                </a>
              </li>
              
              <li>
                <a href="/part04/18/#188-기본-타입-스트림"
                  class="bd-links-link d-inline-block rounded ">
                  18.8 기본 타입 스트림
                </a>
              </li>
              
              <li>
                <a href="/part04/18/#189-프린트-스트림"
                  class="bd-links-link d-inline-block rounded ">
                  18.9 프린트 스트림
                </a>
              </li>
              
              <li>
                <a href="/part04/18/#1810-객체-스트림"
                  class="bd-links-link d-inline-block rounded ">
                  18.10 객체 스트림
                </a>
              </li>
              
              <li>
                <a href="/part04/18/#1811-File과-Files-클래스"
                  class="bd-links-link d-inline-block rounded ">
                  18.11 File과 Files 클래스
                </a>
              </li>
              
            </ul>
          </div>
          
        </li>
        
        <li>
          
          
          
          <button
            class="bd-links-link bd-links-btn btn d-inline-flex align-items-center rounded border-0  w-100"
            data-bs-toggle="collapse" data-bs-target="#collapse-2"
            aria-expanded="true">
            19. 네트워크 입출력
            <svg class="bi ms-auto" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor"
              xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd"
                d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z" />
            </svg>
          </button>
          <div class="collapse show" id="collapse-2">
            <ul class="list-unstyled fw-normal pb-1 small ms-3">
              
              <li>
                <a href="/part04/19/"
                  class="bd-links-link d-inline-block rounded active">
                  19. 네트워크 입출력
                </a>
              </li>
              
              <li>
                <a href="/part04/19/#191-네트워크-기초"
                  class="bd-links-link d-inline-block rounded ">
                  19.1 네트워크 기초
                </a>
              </li>
              
              <li>
                <a href="/part04/19/#192-IP-주소-얻기"
                  class="bd-links-link d-inline-block rounded ">
                  19.2 IP 주소 얻기
                </a>
              </li>
              
              <li>
                <a href="/part04/19/#193-TCP-네트워킹"
                  class="bd-links-link d-inline-block rounded ">
                  19.3 TCP 네트워킹
                </a>
              </li>
              
              <li>
                <a href="/part04/19/#194-UDP-네트워킹"
                  class="bd-links-link d-inline-block rounded ">
                  19.4 UDP 네트워킹
                </a>
              </li>
              
              <li>
                <a href="/part04/19/#195-서버의-동시-요청-처리"
                  class="bd-links-link d-inline-block rounded ">
                  19.5 서버의 동시 요청 처리
                </a>
              </li>
              
              <li>
                <a href="/part04/19/#196-JSON-데이터-형식"
                  class="bd-links-link d-inline-block rounded ">
                  19.6 JSON 데이터 형식
                </a>
              </li>
              
              <li>
                <a href="/part04/19/#197-TCP-채팅-프로그램"
                  class="bd-links-link d-inline-block rounded ">
                  19.7 TCP 채팅 프로그램
                </a>
              </li>
              
            </ul>
          </div>
          
        </li>
        
        <li>
          
          
          
          <button
            class="bd-links-link bd-links-btn btn d-inline-flex align-items-center rounded border-0 collapsed w-100"
            data-bs-toggle="collapse" data-bs-target="#collapse-3"
            aria-expanded="false">
            20. 데이터베이스 입출력
            <svg class="bi ms-auto" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor"
              xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd"
                d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z" />
            </svg>
          </button>
          <div class="collapse " id="collapse-3">
            <ul class="list-unstyled fw-normal pb-1 small ms-3">
              
              <li>
                <a href="/part04/20/"
                  class="bd-links-link d-inline-block rounded ">
                  20. 데이터베이스 입출력
                </a>
              </li>
              
              <li>
                <a href="/part04/20/#201-JDBC-개요"
                  class="bd-links-link d-inline-block rounded ">
                  20.1 JDBC 개요
                </a>
              </li>
              
              <li>
                <a href="/part04/20/#202-DBMS-설치"
                  class="bd-links-link d-inline-block rounded ">
                  20.2 DBMS 설치
                </a>
              </li>
              
              <li>
                <a href="/part04/20/#203-Client-Tool-설치"
                  class="bd-links-link d-inline-block rounded ">
                  20.3 Client Tool 설치
                </a>
              </li>
              
              <li>
                <a href="/part04/20/#204-DB-구성"
                  class="bd-links-link d-inline-block rounded ">
                  20.4 DB 구성
                </a>
              </li>
              
              <li>
                <a href="/part04/20/#205-DB-연결"
                  class="bd-links-link d-inline-block rounded ">
                  20.5 DB 연결
                </a>
              </li>
              
              <li>
                <a href="/part04/20/#206-데이터-저장"
                  class="bd-links-link d-inline-block rounded ">
                  20.6 데이터 저장
                </a>
              </li>
              
              <li>
                <a href="/part04/20/#207-데이터-수정"
                  class="bd-links-link d-inline-block rounded ">
                  20.7 데이터 수정
                </a>
              </li>
              
              <li>
                <a href="/part04/20/#208-데이터-삭제"
                  class="bd-links-link d-inline-block rounded ">
                  20.8 데이터 삭제
                </a>
              </li>
              
              <li>
                <a href="/part04/20/#209-데이터-읽기"
                  class="bd-links-link d-inline-block rounded ">
                  20.9 데이터 읽기
                </a>
              </li>
              
              <li>
                <a href="/part04/20/#2010-프로시저와-함수-호출"
                  class="bd-links-link d-inline-block rounded ">
                  20.10 프로시저와 함수 호출
                </a>
              </li>
              
              <li>
                <a href="/part04/20/#2011-트랜잭션-처리"
                  class="bd-links-link d-inline-block rounded ">
                  20.11 트랜잭션 처리
                </a>
              </li>
              
              <li>
                <a href="/part04/20/#2012-게시판-구현"
                  class="bd-links-link d-inline-block rounded ">
                  20.12 게시판 구현
                </a>
              </li>
              
            </ul>
          </div>
          
        </li>
        
      </ul>
    </li>
  </ul>
</nav>
            </div>
        </div>
    </aside>

    <main class="bd-main order-1">
        <nav aria-label="breadcrumb" class="mt-3">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">Home</a></li>
        
        
        
        
        
        
        
        
        
        <li class="breadcrumb-item"><a href="/part04/">Part04</a></li>
        
        
        
        
        
        
        <li class="breadcrumb-item active" aria-current="page">Chapter 19. 네트워크 입출력</li>
        
        
        
    </ol>
</nav>
        <div class="bd-content ps-lg-2">
            <h1 id="chapter-19-네트워크-입출력">Chapter 19. 네트워크 입출력</h1>

<h2 id="191-네트워크-기초">19.1 네트워크 기초</h2>

<p>네트워크(Network)는 여러 컴퓨터들을 통신 회선으로 연결한 것을 말한다. LAN(Local Area Network)은 가정, 회사, 건물, 특정 영역에 존재하는 컴퓨터를 연결한 것이고, WAN(Wide Area Network)은 LAN을 연결한 것이다. WAN이 우리가 흔히 말하는 인터넷(Internet)이다.</p>

<h3 id="서버와-클라이언트">서버와 클라이언트</h3>

<p>네트워크에서 유무선으로 컴퓨터가 연결되어 있다면 실제로 데이터를 주고받는 행위는 프로그램들이 한다. 서비스를 제공하는 프로그램을 일반적으로 <strong>서버(Server)</strong>라고 부르고, 서비스를 요청하는 프로그램을 <strong>클라이언트(Client)</strong>라고 부른다.</p>

<p>인터넷에서 두 프로그램이 통신하기 위해서는 먼저 클라이언트가 서비스를 요청하고, 서버는 처리 결과를 응답으로 제공해 준다.</p>

<h2 id="192-ip-주소-얻기">19.2 IP 주소 얻기</h2>

<p>컴퓨터에도 고유한 주소가 있다. 바로 <strong>IP(Internet Protocol) 주소</strong>이다. IP 주소는 네트워크 어댑터(LAN 카드)마다 할당된다.</p>

<p>네트워크 어댑터에 어떤 IP 주소가 부여되어 있는지 확인하려면 윈도우에서는 <code class="language-plaintext highlighter-rouge">ipconfig</code> 명령어를, 맥OS에서는 <code class="language-plaintext highlighter-rouge">ifconfig</code> 명령어를 실행하면 된다.</p>

<p>연결할 상대방 컴퓨터의 IP 주소를 모르면 프로그램들은 서로 통신할 수 없다. 우리가 전화번호를 모르면 114로 문의하듯이 프로그램은 <strong>DNS(Domain Name System)</strong>를 이용해서 컴퓨터의 IP 주소를 검색한다. DNS는 도메인 이름으로 IP를 등록하는 저장소이다.</p>

<p>웹 브라우저는 웹 서버와 통신하는 클라이언트로, 사용자가 입력한 도메인 이름으로 DNS에서 IP 주소를 검색해 찾은 다음 웹 서버와 연결해서 웹 페이지를 받는다.</p>

<h3 id="port-번호">Port 번호</h3>

<p>한 대의 컴퓨터에는 다양한 서버 프로그램들이 실행될 수 있다. 예를 들어 웹(Web) 서버, 데이터베이스 관리 시스템(DBMS), FTP 서버 등이 하나의 IP 주소를 갖는 컴퓨터에서 동시에 실행될 수 있다. 이 경우 클라이언트는 어떤 서버와 통신해야 할지 결정해야 한다. IP는 컴퓨터의 네트워크 어댑터까지만 갈 수 있는 정보이기 때문에, 컴퓨터 내부에서 실행하는 서버를 선택하기 위해서는 추가적인 <strong>Port 번호</strong>가 필요하다.</p>

<p>Port는 운영체제가 관리하는 서버 프로그램의 연결 번호이다. 서버는 시작할 때 특정 Port 번호에 바인딩(Binding)한다.</p>

<p>클라이언트도 서버에서 보낸 정보를 받기 위해서는 Port 번호가 필요한데, 서버와 같이 고정적인 Port 번호에 바인딩하는 것이 아니라 운영체제가 자동으로 부여하는 번호를 사용한다.</p>

<p>프로그램에서 사용할 수 있는 전체 Port 번호의 범위는 0 ~ 65535이다.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">구분명</th>
      <th style="text-align: left">범위</th>
      <th style="text-align: left">설명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><strong>Well Known Port Numbers</strong></td>
      <td style="text-align: left">0 ~ 1023</td>
      <td style="text-align: left">국제인터넷주소관리기구(ICANN)가 특정 애플리케이션용으로 미리 예약한 Port</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Registered Port Numbers</strong></td>
      <td style="text-align: left">1024 ~ 49151</td>
      <td style="text-align: left">회사에서 등록해서 사용할 수 있는 Port</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Dynamic Or Private Port Numbers</strong></td>
      <td style="text-align: left">49152 ~ 65535</td>
      <td style="text-align: left">운영체제가 부여하는 동적 Port 또는 개인적인 목적으로 사용할 수 있는 Port</td>
    </tr>
  </tbody>
</table>

<p>자바는 IP 주소를 <code class="language-plaintext highlighter-rouge">java.net</code> 패키지의 <code class="language-plaintext highlighter-rouge">InetAddress</code>로 표현한다.</p>

<ul>
  <li>로컬 컴퓨터의 IP 주소 얻기:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">InetAddress</span> <span class="n">ia</span> <span class="o">=</span> <span class="nc">InetAddress</span><span class="o">.</span><span class="na">getLocalHost</span><span class="o">();</span>
</code></pre></div>    </div>
  </li>
  <li>도메인 이름으로 IP 주소 얻기:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">InetAddress</span> <span class="n">ia</span> <span class="o">=</span> <span class="nc">InetAddress</span><span class="o">.</span><span class="na">getByName</span><span class="o">(</span><span class="nc">String</span> <span class="n">domainName</span><span class="o">);</span>
<span class="nc">InetAddress</span><span class="o">[]</span> <span class="n">iaArr</span> <span class="o">=</span> <span class="nc">InetAddress</span><span class="o">.</span><span class="na">getAllByName</span><span class="o">(</span><span class="nc">String</span> <span class="n">domainName</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
  <li>IP 주소 문자열 얻기:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">ip</span> <span class="o">=</span> <span class="n">ia</span><span class="o">.</span><span class="na">getHostAddress</span><span class="o">();</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">ch19.sec02</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.net.InetAddress</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.UnknownHostException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">InetAddressExample</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="nc">InetAddress</span> <span class="n">local</span> <span class="o">=</span> <span class="nc">InetAddress</span><span class="o">.</span><span class="na">getLocalHost</span><span class="o">();</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"내 컴퓨터 IP 주소: "</span> <span class="o">+</span> <span class="n">local</span><span class="o">.</span><span class="na">getHostAddress</span><span class="o">());</span>

			<span class="nc">InetAddress</span><span class="o">[]</span> <span class="n">iaArr</span> <span class="o">=</span> <span class="nc">InetAddress</span><span class="o">.</span><span class="na">getAllByName</span><span class="o">(</span><span class="s">"www.naver.com"</span><span class="o">);</span>
			<span class="k">for</span> <span class="o">(</span><span class="nc">InetAddress</span> <span class="n">remote</span> <span class="o">:</span> <span class="n">iaArr</span><span class="o">)</span> <span class="o">{</span>
				<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"www.naver.com IP 주소: "</span> <span class="o">+</span> <span class="n">remote</span><span class="o">.</span><span class="na">getHostAddress</span><span class="o">());</span>
			<span class="o">}</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">UnknownHostException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="193-tcp-네트워킹">19.3 TCP 네트워킹</h2>

<p>IP 주소로 프로그램들이 통신할 때는 약속된 데이터 전송 규약이 있다. 이것을 <strong>전송용 프로토콜(Transfer Protocol)</strong>이라고 부른다. 인터넷에서 전송용 프로토콜은 <strong>TCP(Transmission Control Protocol)</strong>와 <strong>UDP(User Datagram Protocol)</strong>가 있다.</p>

<p>TCP는 <strong>연결형 프로토콜</strong>로, 상대방이 연결된 상태에서 데이터를 주고받는다. 클라이언트가 연결 요청을 하고 서버가 연결을 수락하면 통신 회선이 고정되고, 데이터는 고정 회선을 통해 전달된다. 그렇기 때문에 TCP는 보낸 데이터가 순서대로 전달되며 손실이 발생하지 않는다.</p>

<p>자바는 TCP 네트워킹을 위해 <code class="language-plaintext highlighter-rouge">java.net</code> 패키지에서 <code class="language-plaintext highlighter-rouge">ServerSocket</code>과 <code class="language-plaintext highlighter-rouge">Socket</code> 클래스를 제공하고 있다.</p>

<h3 id="tcp-서버">TCP 서버</h3>

<p>TCP 서버 프로그램을 개발하려면 우선 <code class="language-plaintext highlighter-rouge">ServerSocket</code> 객체를 생성해야 한다. 다음은 50001번 Port에 바인딩하는 <code class="language-plaintext highlighter-rouge">ServerSocket</code>를 생성하는 코드이다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">ServerSocket</span> <span class="n">serverSocket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ServerSocket</span><span class="o">(</span><span class="mi">50001</span><span class="o">);</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">ServerSocket</code>이 생성되었다면 연결 요청을 수락을 위해 <code class="language-plaintext highlighter-rouge">accept()</code> 메소드를 실행해야 한다. <code class="language-plaintext highlighter-rouge">accept()</code>는 클라이언트가 연결 요청하기 전까지 블로킹된다. 클라이언트의 연결 요청이 들어오면 블로킹이 해제되고 통신용 <code class="language-plaintext highlighter-rouge">Socket</code>을 리턴한다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="n">serverSocket</span><span class="o">.</span><span class="na">accept</span><span class="o">();</span>
</code></pre></div></div>

<p>연결된 클라이언트의 IP 주소와 Port 번호를 얻고 싶다면 다음과 같이 할 수 있다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">InetSocketAddress</span> <span class="n">isa</span> <span class="o">=</span> <span class="o">(</span><span class="nc">InetSocketAddress</span><span class="o">)</span> <span class="n">socket</span><span class="o">.</span><span class="na">getRemoteSocketAddress</span><span class="o">();</span>
<span class="nc">String</span> <span class="n">clientIp</span> <span class="o">=</span> <span class="n">isa</span><span class="o">.</span><span class="na">getHostName</span><span class="o">();</span> <span class="c1">// 또는 isa.getHostString()</span>
<span class="nc">String</span> <span class="n">portNo</span> <span class="o">=</span> <span class="n">isa</span><span class="o">.</span><span class="na">getPort</span><span class="o">();</span>
</code></pre></div></div>

<p>서버를 종료하려면 <code class="language-plaintext highlighter-rouge">ServerSocket</code>의 <code class="language-plaintext highlighter-rouge">close()</code> 메소드를 호출해서 Port 번호를 언바인딩시켜야 한다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serverSocket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">ch19.sec03.exam01</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.InetSocketAddress</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.ServerSocket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.Socket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ServerExample</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="nc">ServerSocket</span> <span class="n">serverSocket</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--------------------------------------------------------------------"</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"서버를 종료하려면 q 또는 Q를 입력하고 Enter 키를 입력하세요."</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--------------------------------------------------------------------"</span><span class="o">);</span>

		<span class="c1">// TCP 서버 시작</span>
		<span class="n">startServer</span><span class="o">();</span>

		<span class="c1">// 키보드 입력</span>
		<span class="nc">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
		<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
			<span class="nc">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"q"</span><span class="o">))</span> <span class="o">{</span>
				<span class="k">break</span><span class="o">;</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="n">scanner</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

		<span class="c1">// TCP 서버 종료</span>
		<span class="n">stopServer</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">startServer</span><span class="o">()</span> <span class="o">{</span>
		<span class="c1">// 작업 스레드 정의</span>
		<span class="nc">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">()</span> <span class="o">{</span>
			<span class="nd">@Override</span>
			<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
				<span class="k">try</span> <span class="o">{</span>
					<span class="c1">// ServerSocket 생성 및 Port 바인딩</span>
					<span class="n">serverSocket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ServerSocket</span><span class="o">(</span><span class="mi">50001</span><span class="o">);</span>
					<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] 시작됨"</span><span class="o">);</span>

					<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
						<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"\n[서버] 연결 요청을 기다림\n"</span><span class="o">);</span>
						<span class="c1">// 연결 수락</span>
						<span class="nc">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="n">serverSocket</span><span class="o">.</span><span class="na">accept</span><span class="o">();</span>

						<span class="c1">// 연결된 클라이언트 정보 얻기</span>
						<span class="nc">InetSocketAddress</span> <span class="n">isa</span> <span class="o">=</span> <span class="o">(</span><span class="nc">InetSocketAddress</span><span class="o">)</span> <span class="n">socket</span><span class="o">.</span><span class="na">getRemoteSocketAddress</span><span class="o">();</span>
						<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] "</span> <span class="o">+</span> <span class="n">isa</span><span class="o">.</span><span class="na">getHostString</span><span class="o">()</span> <span class="o">+</span> <span class="s">"의 연결 요청을 수락함"</span><span class="o">);</span>

						<span class="c1">// 연결 끊기</span>
						<span class="n">socket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
						<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] "</span> <span class="o">+</span> <span class="n">isa</span><span class="o">.</span><span class="na">getHostString</span><span class="o">()</span> <span class="o">+</span> <span class="s">"의 연결을 끊음"</span><span class="o">);</span>
					<span class="o">}</span>
				<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
					<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">};</span>
		<span class="c1">// 스레드 시작</span>
		<span class="n">thread</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">stopServer</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="c1">// ServerSocket을 닫고 Port 언바인딩</span>
			<span class="n">serverSocket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] 종료됨"</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e1</span><span class="o">)</span> <span class="o">{}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="tcp-클라이언트">TCP 클라이언트</h3>

<p>클라이언트가 서버에 연결 요청을 하려면 <code class="language-plaintext highlighter-rouge">Socket</code> 객체를 생성할 때 생성자 매개값으로 서버 IP 주소와 Port 번호를 제공하면 된다. 로컬 컴퓨터에서 실행하는 서버로 연결 요청을 할 경우에는 IP 주소 대신 <code class="language-plaintext highlighter-rouge">localhost</code>를 사용할 수 있다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Socket</span><span class="o">(</span><span class="s">"IP"</span><span class="o">,</span> <span class="mi">50001</span><span class="o">);</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">ch19.sec03.exam01</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.Socket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.UnknownHostException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ClientExample</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="c1">// Socket 생성과 동시에 localhost의 50001 Port로 연결 요청</span>
			<span class="nc">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Socket</span><span class="o">(</span><span class="s">"localhost"</span><span class="o">,</span> <span class="mi">50001</span><span class="o">);</span>

			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[클라이언트] 연결 성공"</span><span class="o">);</span>

			<span class="c1">// Socket 닫기</span>
			<span class="n">socket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[클라이언트] 연결 끊음"</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">UnknownHostException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="c1">// IP 표기 방법이 잘못되었을 경우</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="c1">// 해당 포트의 서버에 연결할 수 없는 경우</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="입출력-스트림으로-데이터-주고받기">입출력 스트림으로 데이터 주고받기</h3>

<p>클라이언트가 연결 요청(<code class="language-plaintext highlighter-rouge">connect()</code>)을 하고 서버가 연결 수락(<code class="language-plaintext highlighter-rouge">accept()</code>)했다면, 양쪽의 <code class="language-plaintext highlighter-rouge">Socket</code> 객체로부터 각각 입력 스트림(<code class="language-plaintext highlighter-rouge">InputStream</code>)과 출력 스트림(<code class="language-plaintext highlighter-rouge">OutputStream</code>)을 얻을 수 있다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
<span class="nc">OutputStream</span> <span class="n">os</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">();</span>
</code></pre></div></div>

<p>다음은 TCP 클라이언트가 보낸 메시지를 다시 돌려보내는 에코(Echo) TCP 서버를 구현한 예제이다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">ch19.sec03.exam02</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.DataInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.DataOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.OutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.InetSocketAddress</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.ServerSocket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.Socket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EchoServer</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="nc">ServerSocket</span> <span class="n">serverSocket</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--------------------------------------------------------------------"</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"서버를 종료하려면 q를 입력하고 Enter 키를 입력하세요."</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--------------------------------------------------------------------"</span><span class="o">);</span>

		<span class="c1">// TCP 서버 시작</span>
		<span class="n">startServer</span><span class="o">();</span>

		<span class="c1">// 키보드 입력</span>
		<span class="nc">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
		<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
			<span class="nc">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"q"</span><span class="o">))</span> <span class="o">{</span>
				<span class="k">break</span><span class="o">;</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="n">scanner</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

		<span class="c1">// TCP 서버 종료</span>
		<span class="n">stopServer</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">startServer</span><span class="o">()</span> <span class="o">{</span>
		<span class="c1">// 작업 스레드 정의</span>
		<span class="nc">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">()</span> <span class="o">{</span>
			<span class="nd">@Override</span>
			<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
				<span class="k">try</span> <span class="o">{</span>
					<span class="c1">// ServerSocket 생성 및 Port 바인딩</span>
					<span class="n">serverSocket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ServerSocket</span><span class="o">(</span><span class="mi">50001</span><span class="o">);</span>
					<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] 시작됨"</span><span class="o">);</span>

					<span class="c1">// 연결 수락 및 데이터 통신</span>
					<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
						<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"\n[서버] 연결 요청을 기다림\n"</span><span class="o">);</span>
						<span class="c1">// 연결 수락</span>
						<span class="nc">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="n">serverSocket</span><span class="o">.</span><span class="na">accept</span><span class="o">();</span>

						<span class="c1">// 연결된 클라이언트 정보 얻기</span>
						<span class="nc">InetSocketAddress</span> <span class="n">isa</span> <span class="o">=</span> <span class="o">(</span><span class="nc">InetSocketAddress</span><span class="o">)</span> <span class="n">socket</span><span class="o">.</span><span class="na">getRemoteSocketAddress</span><span class="o">();</span>
						<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] "</span> <span class="o">+</span> <span class="n">isa</span><span class="o">.</span><span class="na">getHostName</span><span class="o">()</span> <span class="o">+</span> <span class="s">"의 연결 요청을 수락함"</span><span class="o">);</span>

						<span class="cm">/*
						// 데이터 받기
						InputStream is = socket.getInputStream();
						byte[] bytes = new byte[1024];
						int readByteCount = is.read(bytes);
						String message = new String(bytes, 0, readByteCount, "UTF-8");

						// 데이터 보내기
						OutputStream os = socket.getOutputStream();
						bytes = message.getBytes("UTF-8");
						os.write(bytes);
						os.flush();
						System.out.println("[서버] 받은 데이터를 다시 보냄: " + message);
						*/</span>

						<span class="c1">// 데이터 받기</span>
						<span class="nc">DataInputStream</span> <span class="n">dis</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataInputStream</span><span class="o">(</span><span class="n">socket</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">());</span>
						<span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">dis</span><span class="o">.</span><span class="na">readUTF</span><span class="o">();</span>

						<span class="c1">// 데이터 보내기</span>
						<span class="nc">DataOutputStream</span> <span class="n">dos</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataOutputStream</span><span class="o">(</span><span class="n">socket</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">());</span>
						<span class="n">dos</span><span class="o">.</span><span class="na">writeUTF</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
						<span class="n">dos</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
						<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] 받은 데이터를 다시 보냄: "</span> <span class="o">+</span> <span class="n">message</span><span class="o">);</span>

						<span class="c1">// 연결 끊기</span>
						<span class="n">socket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
						<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] "</span> <span class="o">+</span> <span class="n">isa</span><span class="o">.</span><span class="na">getHostName</span><span class="o">()</span> <span class="o">+</span> <span class="s">"의 연결을 끊음"</span><span class="o">);</span>
					<span class="o">}</span>
				<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
					<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">};</span>
		<span class="c1">// 스레드 시작</span>
		<span class="n">thread</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">stopServer</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="c1">// ServerSocket을 닫고 Port 언바인딩</span>
			<span class="n">serverSocket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] 종료됨"</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e1</span><span class="o">)</span> <span class="o">{}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">ch19.sec03.exam02</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.DataInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.DataOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.OutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.Socket</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EchoClient</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="c1">// Socket 생성과 동시에 localhost의 50001 포트로 연결 요청</span>
			<span class="nc">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Socket</span><span class="o">(</span><span class="s">"localhost"</span><span class="o">,</span> <span class="mi">50001</span><span class="o">);</span>

			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[클라이언트] 연결 성공"</span><span class="o">);</span>

			<span class="cm">/*
			// 데이터 보내기
			String sendMessage = "나는 자바가 좋아~~";
			OutputStream os = socket.getOutputStream();
			byte[] bytes = sendMessage.getBytes("UTF-8");
			os.write(bytes);
			os.flush();
			System.out.println("[클라이언트] 데이터 보냄: " + sendMessage);

			// 데이터 받기
			InputStream is = socket.getInputStream();
			bytes = new byte[1024];
			int readByteCount = is.read(bytes);
			String receiveMessage = new String(bytes, 0, readByteCount, "UTF-8");
			System.out.println("[클라이언트] 데이터 받음: " + receiveMessage);
			*/</span>

			<span class="c1">// 데이터 보내기</span>
			<span class="nc">String</span> <span class="n">sendMessage</span> <span class="o">=</span> <span class="s">"나는 자바가 좋아~~"</span><span class="o">;</span>
			<span class="nc">DataOutputStream</span> <span class="n">dos</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataOutputStream</span><span class="o">(</span><span class="n">socket</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">());</span>
			<span class="n">dos</span><span class="o">.</span><span class="na">writeUTF</span><span class="o">(</span><span class="n">sendMessage</span><span class="o">);</span>
			<span class="n">dos</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[클라이언트] 데이터 보냄: "</span> <span class="o">+</span> <span class="n">sendMessage</span><span class="o">);</span>

			<span class="c1">// 데이터 받기</span>
			<span class="nc">DataInputStream</span> <span class="n">dis</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataInputStream</span><span class="o">(</span><span class="n">socket</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">());</span>
			<span class="nc">String</span> <span class="n">receiveMessage</span> <span class="o">=</span> <span class="n">dis</span><span class="o">.</span><span class="na">readUTF</span><span class="o">();</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[클라이언트] 데이터 받음: "</span> <span class="o">+</span> <span class="n">receiveMessage</span><span class="o">);</span>

			<span class="c1">// 연결 끊기</span>
			<span class="n">socket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[클라이언트] 연결 끊음"</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="194-udp-네트워킹">19.4 UDP 네트워킹</h2>

<p><strong>UDP(User Datagram Protocol)</strong>는 발신자가 일방적으로 수신자에게 데이터를 보내는 방식으로, TCP처럼 연결 요청 및 수락 과정이 없기 때문에 TCP보다 데이터 전송 속도가 상대적으로 빠르다. 하지만 데이터 신뢰성은 낮다.</p>

<p>자바는 UDP 네트워킹을 위해 <code class="language-plaintext highlighter-rouge">java.net</code> 패키지에서 <code class="language-plaintext highlighter-rouge">DatagramSocket</code>과 <code class="language-plaintext highlighter-rouge">DatagramPacket</code> 클래스를 제공하고 있다. <code class="language-plaintext highlighter-rouge">DatagramSocket</code>은 발신점과 수신점에 해당하고, <code class="language-plaintext highlighter-rouge">DatagramPacket</code>은 주고받는 데이터에 해당한다.</p>

<h3 id="udp-서버">UDP 서버</h3>

<p>UDP 서버를 위한 <code class="language-plaintext highlighter-rouge">DatagramSocket</code> 객체를 생성할 때에는 다음과 같이 바인딩할 Port 번호를 생성자 매개값으로 제공해야 한다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">DatagramSocket</span> <span class="n">datagramSocket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DatagramSocket</span><span class="o">(</span><span class="mi">50001</span><span class="o">);</span>
</code></pre></div></div>

<p>데이터 수신은 <code class="language-plaintext highlighter-rouge">receive()</code> 메소드를 사용한다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">DatagramPacket</span> <span class="n">receivePacket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DatagramPacket</span><span class="o">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">],</span> <span class="mi">1024</span><span class="o">);</span>
<span class="n">datagramSocket</span><span class="o">.</span><span class="na">receive</span><span class="o">(</span><span class="n">receivePacket</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="udp-클라이언트">UDP 클라이언트</h3>

<p>UDP 클라이언트를 위한 <code class="language-plaintext highlighter-rouge">DatagramSocket</code> 객체는 기본 생성자로 생성한다. <code class="language-plaintext highlighter-rouge">Port</code> 번호는 자동으로 부여된다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">DatagramSocket</span> <span class="n">datagramSocket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DatagramSocket</span><span class="o">();</span>
</code></pre></div></div>

<p>데이터 전송은 <code class="language-plaintext highlighter-rouge">send()</code> 메소드를 사용한다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">DatagramPacket</span> <span class="n">sendPacket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DatagramPacket</span><span class="o">(</span><span class="n">bytes</span><span class="o">,</span> <span class="n">bytes</span><span class="o">.</span><span class="na">length</span><span class="o">,</span> <span class="k">new</span> <span class="nc">InetSocketAddress</span><span class="o">(</span><span class="s">"localhost"</span><span class="o">,</span> <span class="mi">50001</span><span class="o">));</span>
<span class="n">datagramSocket</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">sendPacket</span><span class="o">);</span>
</code></pre></div></div>

<p>다음 예제는 UDP 클라이언트가 구독하고 싶은 뉴스를 전송하면 UDP 서버가 관련 뉴스 10개를 전송하는 예제이다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">ch19.sec04</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.net.DatagramPacket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.DatagramSocket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.SocketAddress</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NewsServer</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="nc">DatagramSocket</span> <span class="n">datagramSocket</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--------------------------------------------------------------------"</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"서버를 종료하려면 q를 입력하고 Enter 키를 입력하세요."</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--------------------------------------------------------------------"</span><span class="o">);</span>

		<span class="c1">// UDP 서버 시작</span>
		<span class="n">startServer</span><span class="o">();</span>

		<span class="c1">// 키보드 입력</span>
		<span class="nc">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
		<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
			<span class="nc">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"q"</span><span class="o">))</span> <span class="o">{</span>
				<span class="k">break</span><span class="o">;</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="n">scanner</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

		<span class="c1">// UDP 서버 종료</span>
		<span class="n">stopServer</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">startServer</span><span class="o">()</span> <span class="o">{</span>
		<span class="c1">// 작업 스레드 정의</span>
		<span class="nc">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">()</span> <span class="o">{</span>
			<span class="nd">@Override</span>
			<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
				<span class="k">try</span> <span class="o">{</span>
					<span class="c1">// DatagramSocket 생성 및 Port 바인딩</span>
					<span class="n">datagramSocket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DatagramSocket</span><span class="o">(</span><span class="mi">50001</span><span class="o">);</span>
					<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] 시작됨"</span><span class="o">);</span>

					<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
						<span class="c1">// 클라이언트가 구독하고 싶은 뉴스 주제 얻기</span>
						<span class="nc">DatagramPacket</span> <span class="n">receivePacket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DatagramPacket</span><span class="o">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">],</span> <span class="mi">1024</span><span class="o">);</span>
						<span class="n">datagramSocket</span><span class="o">.</span><span class="na">receive</span><span class="o">(</span><span class="n">receivePacket</span><span class="o">);</span>
						<span class="nc">String</span> <span class="n">newsKind</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">receivePacket</span><span class="o">.</span><span class="na">getData</span><span class="o">(),</span> <span class="mi">0</span><span class="o">,</span> <span class="n">receivePacket</span><span class="o">.</span><span class="na">getLength</span><span class="o">(),</span> <span class="s">"UTF-8"</span><span class="o">);</span>

						<span class="c1">// 클라이언트의 IP와 Port 얻기</span>
						<span class="nc">SocketAddress</span> <span class="n">socketAddress</span> <span class="o">=</span> <span class="n">receivePacket</span><span class="o">.</span><span class="na">getSocketAddress</span><span class="o">();</span>

						<span class="c1">// 10개의 뉴스를 클라이언트로 전송</span>
						<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
							<span class="nc">String</span> <span class="n">data</span> <span class="o">=</span> <span class="n">newsKind</span> <span class="o">+</span> <span class="s">": 뉴스"</span> <span class="o">+</span> <span class="n">i</span><span class="o">;</span>
							<span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="s">"UTF-8"</span><span class="o">);</span>
							<span class="nc">DatagramPacket</span> <span class="n">sendPacket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DatagramPacket</span><span class="o">(</span><span class="n">bytes</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">bytes</span><span class="o">.</span><span class="na">length</span><span class="o">,</span> <span class="n">socketAddress</span><span class="o">);</span>
							<span class="n">datagramSocket</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">sendPacket</span><span class="o">);</span>
						<span class="o">}</span>
					<span class="o">}</span>
				<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
					<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">};</span>
		<span class="c1">// 스레드 시작</span>
		<span class="n">thread</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">stopServer</span><span class="o">()</span> <span class="o">{</span>
		<span class="c1">// DatagramSocket을 닫고 Port 언바인딩</span>
		<span class="n">datagramSocket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] 종료됨"</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">ch19.sec04</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.net.DatagramPacket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.DatagramSocket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.InetSocketAddress</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NewsClient</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="c1">// DatagramSocket 생성</span>
			<span class="nc">DatagramSocket</span> <span class="n">datagramSocket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DatagramSocket</span><span class="o">();</span>

			<span class="c1">// 구독하고 싶은 뉴스 주제 보내기</span>
			<span class="nc">String</span> <span class="n">data</span> <span class="o">=</span> <span class="s">"정치"</span><span class="o">;</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="s">"UTF-8"</span><span class="o">);</span>
			<span class="nc">DatagramPacket</span> <span class="n">sendPacket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DatagramPacket</span><span class="o">(</span>
				<span class="n">bytes</span><span class="o">,</span> <span class="n">bytes</span><span class="o">.</span><span class="na">length</span><span class="o">,</span> <span class="k">new</span> <span class="nc">InetSocketAddress</span><span class="o">(</span><span class="s">"localhost"</span><span class="o">,</span> <span class="mi">50001</span><span class="o">)</span>
			<span class="o">);</span>
			<span class="n">datagramSocket</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">sendPacket</span><span class="o">);</span>

			<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
				<span class="c1">// 뉴스 받기</span>
				<span class="nc">DatagramPacket</span> <span class="n">receivePacket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DatagramPacket</span><span class="o">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">],</span> <span class="mi">1024</span><span class="o">);</span>
				<span class="n">datagramSocket</span><span class="o">.</span><span class="na">receive</span><span class="o">(</span><span class="n">receivePacket</span><span class="o">);</span>

				<span class="c1">// 문자열로 변환</span>
				<span class="nc">String</span> <span class="n">news</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">receivePacket</span><span class="o">.</span><span class="na">getData</span><span class="o">(),</span> <span class="mi">0</span><span class="o">,</span> <span class="n">receivePacket</span><span class="o">.</span><span class="na">getLength</span><span class="o">(),</span> <span class="s">"UTF-8"</span><span class="o">);</span>
				<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">news</span><span class="o">);</span>

				<span class="c1">// 10번째 뉴스를 받으면 while 문 종료</span>
				<span class="k">if</span> <span class="o">(</span><span class="n">news</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"뉴스10"</span><span class="o">))</span> <span class="o">{</span>
					<span class="k">break</span><span class="o">;</span>
				<span class="o">}</span>
			<span class="o">}</span>

			<span class="c1">// DatagramSocket 닫기</span>
			<span class="n">datagramSocket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="195-서버의-동시-요청-처리">19.5 서버의 동시 요청 처리</h2>

<p>일반적으로 서버는 다수의 클라이언트와 통신을 한다. <code class="language-plaintext highlighter-rouge">accept()</code>와 <code class="language-plaintext highlighter-rouge">receive()</code>를 제외한 요청 처리 코드를 별도의 스레드에서 작업하는 것이 좋다. 스레드를 처리할 때 주의할 점은 클라이언트의 폭증으로 인한 서버의 과도한 스레드 생성을 방지해야 한다는 것이다. 그래서 <strong>스레드풀(ExecutorService)</strong>을 사용하는 것이 바람직하다.</p>

<h3 id="tcp-echoserver-동시-요청-처리">TCP EchoServer 동시 요청 처리</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">ch19.sec05.exam01</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.DataInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.DataOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.InetSocketAddress</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.ServerSocket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.Socket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.ExecutorService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Executors</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EchoServer</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="nc">ServerSocket</span> <span class="n">serverSocket</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="nc">ExecutorService</span> <span class="n">executorService</span> <span class="o">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="na">newFixedThreadPool</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span> <span class="c1">// 10개의 스레드로 요청을 처리하는 스레드풀 생성</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--------------------------------------------------------------------"</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"서버를 종료하려면 q를 입력하고 Enter 키를 입력하세요."</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--------------------------------------------------------------------"</span><span class="o">);</span>

		<span class="c1">// TCP 서버 시작</span>
		<span class="n">startServer</span><span class="o">();</span>

		<span class="c1">// 키보드 입력</span>
		<span class="nc">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
		<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
			<span class="nc">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"q"</span><span class="o">))</span> <span class="o">{</span>
				<span class="k">break</span><span class="o">;</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="n">scanner</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

		<span class="c1">// TCP 서버 종료</span>
		<span class="n">stopServer</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">startServer</span><span class="o">()</span> <span class="o">{</span>
		<span class="c1">// 작업 스레드 정의</span>
		<span class="nc">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">()</span> <span class="o">{</span>
			<span class="nd">@Override</span>
			<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
				<span class="k">try</span> <span class="o">{</span>
					<span class="c1">// ServerSocket 생성 및 Port 바인딩</span>
					<span class="n">serverSocket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ServerSocket</span><span class="o">(</span><span class="mi">50001</span><span class="o">);</span>
					<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] 시작됨\n"</span><span class="o">);</span>

					<span class="c1">// 연결 수락 및 데이터 통신</span>
					<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
						<span class="c1">// 연결 수락</span>
						<span class="nc">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="n">serverSocket</span><span class="o">.</span><span class="na">accept</span><span class="o">();</span>

						<span class="n">executorService</span><span class="o">.</span><span class="na">execute</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
							<span class="k">try</span> <span class="o">{</span>
								<span class="c1">// 연결된 클라이언트 정보 얻기</span>
								<span class="nc">InetSocketAddress</span> <span class="n">isa</span> <span class="o">=</span> <span class="o">(</span><span class="nc">InetSocketAddress</span><span class="o">)</span> <span class="n">socket</span><span class="o">.</span><span class="na">getRemoteSocketAddress</span><span class="o">();</span>
								<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] "</span> <span class="o">+</span> <span class="n">isa</span><span class="o">.</span><span class="na">getHostName</span><span class="o">()</span> <span class="o">+</span> <span class="s">"의 연결 요청을 수락함"</span><span class="o">);</span>

								<span class="c1">// 데이터 받기</span>
								<span class="nc">DataInputStream</span> <span class="n">dis</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataInputStream</span><span class="o">(</span><span class="n">socket</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">());</span>
								<span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">dis</span><span class="o">.</span><span class="na">readUTF</span><span class="o">();</span>

								<span class="c1">// 데이터 보내기</span>
								<span class="nc">DataOutputStream</span> <span class="n">dos</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataOutputStream</span><span class="o">(</span><span class="n">socket</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">());</span>
								<span class="n">dos</span><span class="o">.</span><span class="na">writeUTF</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
								<span class="n">dos</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
								<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] 받은 데이터를 다시 보냄: "</span> <span class="o">+</span> <span class="n">message</span><span class="o">);</span>

								<span class="c1">// 연결 끊기</span>
								<span class="n">socket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
								<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] "</span> <span class="o">+</span> <span class="n">isa</span><span class="o">.</span><span class="na">getHostName</span><span class="o">()</span> <span class="o">+</span> <span class="s">"의 연결을 끊음\n"</span><span class="o">);</span>
							<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
							<span class="o">}</span>
						<span class="o">});</span>
					<span class="o">}</span>
				<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
					<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">};</span>
		<span class="c1">// 스레드 시작</span>
		<span class="n">thread</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">stopServer</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="c1">// ServerSocket을 닫고 Port 언바인딩</span>
			<span class="n">serverSocket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
			<span class="n">executorService</span><span class="o">.</span><span class="na">shutdownNow</span><span class="o">();</span> <span class="c1">// 스레드풀 종료</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] 종료됨"</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e1</span><span class="o">)</span> <span class="o">{}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="udp-newsserver-동시-요청-처리">UDP NewsServer 동시 요청 처리</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">ch19.sec05.exam02</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.net.DatagramPacket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.DatagramSocket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.SocketAddress</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.ExecutorService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Executors</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NewsServer</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="nc">DatagramSocket</span> <span class="n">datagramSocket</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="nc">ExecutorService</span> <span class="n">executorService</span> <span class="o">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="na">newFixedThreadPool</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span> <span class="c1">// 10개의 스레드로 요청을 처리하는 스레드풀 생성</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--------------------------------------------------------------------"</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"서버를 종료하려면 q를 입력하고 Enter 키를 입력하세요."</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--------------------------------------------------------------------"</span><span class="o">);</span>

		<span class="c1">// UDP 서버 시작</span>
		<span class="n">startServer</span><span class="o">();</span>

		<span class="c1">// 키보드 입력</span>
		<span class="nc">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
		<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
			<span class="nc">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"q"</span><span class="o">))</span> <span class="o">{</span>
				<span class="k">break</span><span class="o">;</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="n">scanner</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

		<span class="c1">// UDP 서버 종료</span>
		<span class="n">stopServer</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">startServer</span><span class="o">()</span> <span class="o">{</span>
		<span class="c1">// 작업 스레드 정의</span>
		<span class="nc">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">()</span> <span class="o">{</span>
			<span class="nd">@Override</span>
			<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
				<span class="k">try</span> <span class="o">{</span>
					<span class="c1">// DatagramSocket 생성 및 Port 바인딩</span>
					<span class="n">datagramSocket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DatagramSocket</span><span class="o">(</span><span class="mi">50001</span><span class="o">);</span>
					<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] 시작됨"</span><span class="o">);</span>

					<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
						<span class="c1">// 클라이언트가 구독하고 싶은 뉴스 주제 얻기</span>
						<span class="nc">DatagramPacket</span> <span class="n">receivePacket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DatagramPacket</span><span class="o">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">],</span> <span class="mi">1024</span><span class="o">);</span>
						<span class="n">datagramSocket</span><span class="o">.</span><span class="na">receive</span><span class="o">(</span><span class="n">receivePacket</span><span class="o">);</span>

						<span class="n">executorService</span><span class="o">.</span><span class="na">execute</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
							<span class="k">try</span> <span class="o">{</span>
								<span class="nc">String</span> <span class="n">newsKind</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">receivePacket</span><span class="o">.</span><span class="na">getData</span><span class="o">(),</span> <span class="mi">0</span><span class="o">,</span> <span class="n">receivePacket</span><span class="o">.</span><span class="na">getLength</span><span class="o">(),</span> <span class="s">"UTF-8"</span><span class="o">);</span>

								<span class="c1">// 클라이언트의 IP와 Port 얻기</span>
								<span class="nc">SocketAddress</span> <span class="n">socketAddress</span> <span class="o">=</span> <span class="n">receivePacket</span><span class="o">.</span><span class="na">getSocketAddress</span><span class="o">();</span>

								<span class="c1">// 10개의 뉴스를 클라이언트로 전송</span>
								<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
									<span class="nc">String</span> <span class="n">data</span> <span class="o">=</span> <span class="n">newsKind</span> <span class="o">+</span> <span class="s">": 뉴스"</span> <span class="o">+</span> <span class="n">i</span><span class="o">;</span>
									<span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="s">"UTF-8"</span><span class="o">);</span>
									<span class="nc">DatagramPacket</span> <span class="n">sendPacket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DatagramPacket</span><span class="o">(</span><span class="n">bytes</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">bytes</span><span class="o">.</span><span class="na">length</span><span class="o">,</span> <span class="n">socketAddress</span><span class="o">);</span>
									<span class="n">datagramSocket</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">sendPacket</span><span class="o">);</span>
								<span class="o">}</span>
							<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
							<span class="o">}</span>
						<span class="o">});</span>
					<span class="o">}</span>
				<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
					<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">};</span>
		<span class="c1">// 스레드 시작</span>
		<span class="n">thread</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">stopServer</span><span class="o">()</span> <span class="o">{</span>
		<span class="c1">// DatagramSocket을 닫고 Port 언바인딩</span>
		<span class="n">datagramSocket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="n">executorService</span><span class="o">.</span><span class="na">shutdownNow</span><span class="o">();</span> <span class="c1">// 스레드풀 종료</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] 종료됨"</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="196-json-데이터-형식">19.6 JSON 데이터 형식</h2>

<p>네트워크로 전달하는 데이터가 복잡할수록 구조화된 형식이 필요하다. <strong>JSON(JavaScript Object Notation)</strong>은 네트워크 통신에서 가장 많이 사용되는 데이터 형식이다.</p>

<p>JSON을 자바에서 처리하기 위해 <code class="language-plaintext highlighter-rouge">org.json</code> 라이브러리를 사용한다.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">JSONObject</code>: JSON 객체 표기를 생성하거나 파싱할 때 사용</li>
  <li><code class="language-plaintext highlighter-rouge">JSONArray</code>: JSON 배열 표기를 생성하거나 파싱할 때 사용</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">ch19.sec06</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.FileWriter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.Writer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.Charset</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.json.JSONArray</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.JSONObject</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CreateJsonExample</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
		<span class="c1">// JSON 객체 생성</span>
		<span class="nc">JSONObject</span> <span class="n">root</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">();</span>

		<span class="c1">// 속성 추가</span>
		<span class="n">root</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span> <span class="s">"winter"</span><span class="o">);</span>
		<span class="n">root</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="s">"한겨울"</span><span class="o">);</span>
		<span class="n">root</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"age"</span><span class="o">,</span> <span class="mi">25</span><span class="o">);</span>
		<span class="n">root</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"student"</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>

		<span class="c1">// 객체 속성 추가</span>
		<span class="nc">JSONObject</span> <span class="n">tel</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">();</span>
		<span class="n">tel</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"home"</span><span class="o">,</span> <span class="s">"02-123-1234"</span><span class="o">);</span>
		<span class="n">tel</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"mobile"</span><span class="o">,</span> <span class="s">"010-123-1234"</span><span class="o">);</span>
		<span class="n">root</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"tel"</span><span class="o">,</span> <span class="n">tel</span><span class="o">);</span>

		<span class="c1">// 배열 속성 추가</span>
		<span class="nc">JSONArray</span> <span class="n">skill</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONArray</span><span class="o">();</span>
		<span class="n">skill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"java"</span><span class="o">);</span>
		<span class="n">skill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"c"</span><span class="o">);</span>
		<span class="n">skill</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"c++"</span><span class="o">);</span>
		<span class="n">root</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"skill"</span><span class="o">,</span> <span class="n">skill</span><span class="o">);</span>

		<span class="c1">// JSON 얻기</span>
		<span class="nc">String</span> <span class="n">json</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>

		<span class="c1">// 콘솔에 출력</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">json</span><span class="o">);</span>

		<span class="c1">// 파일로 저장</span>
		<span class="nc">Writer</span> <span class="n">writer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileWriter</span><span class="o">(</span><span class="s">"C:/Temp/member.json"</span><span class="o">,</span> <span class="nc">Charset</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"UTF-8"</span><span class="o">));</span>
		<span class="n">writer</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">json</span><span class="o">);</span>
		<span class="n">writer</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
		<span class="n">writer</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">ch19.sec06</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.BufferedReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.Charset</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.json.JSONArray</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.JSONObject</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ParseJsonExample</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
		<span class="c1">// 파일로부터 JSON 읽기</span>
		<span class="nc">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span>
			<span class="k">new</span> <span class="nf">FileReader</span><span class="o">(</span><span class="s">"C:/Temp/member.json"</span><span class="o">,</span> <span class="nc">Charset</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"UTF-8"</span><span class="o">))</span>
		<span class="o">);</span>
		<span class="nc">String</span> <span class="n">json</span> <span class="o">=</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">();</span>
		<span class="n">br</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

		<span class="c1">// JSON 파싱</span>
		<span class="nc">JSONObject</span> <span class="n">root</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">(</span><span class="n">json</span><span class="o">);</span>

		<span class="c1">// 속성 정보 읽기</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"id: "</span> <span class="o">+</span> <span class="n">root</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"id"</span><span class="o">));</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"name: "</span> <span class="o">+</span> <span class="n">root</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"name"</span><span class="o">));</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"age: "</span> <span class="o">+</span> <span class="n">root</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"age"</span><span class="o">));</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"student: "</span> <span class="o">+</span> <span class="n">root</span><span class="o">.</span><span class="na">getBoolean</span><span class="o">(</span><span class="s">"student"</span><span class="o">));</span>

		<span class="c1">// 객체 속성 정보 읽기</span>
		<span class="nc">JSONObject</span> <span class="n">tel</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="s">"tel"</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"home: "</span> <span class="o">+</span> <span class="n">tel</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"home"</span><span class="o">));</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"mobile: "</span> <span class="o">+</span> <span class="n">tel</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"mobile"</span><span class="o">));</span>

		<span class="c1">// 배열 속성 정보 읽기</span>
		<span class="nc">JSONArray</span> <span class="n">skill</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">getJSONArray</span><span class="o">(</span><span class="s">"skill"</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"skill: "</span><span class="o">);</span>
		<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">skill</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">skill</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">+</span> <span class="s">", "</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="197-tcp-채팅-프로그램">19.7 TCP 채팅 프로그램</h2>

<p>TCP 네트워킹을 이용해서 채팅 서버와 클라이언트를 구현할 수 있다.</p>

<h3 id="채팅-서버">채팅 서버</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">ch19.sec07</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.ServerSocket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.Socket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Collection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Collections</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.ExecutorService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Executors</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.json.JSONObject</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ChatServer</span> <span class="o">{</span>
	<span class="c1">// 필드</span>
	<span class="nc">ServerSocket</span> <span class="n">serverSocket</span><span class="o">;</span>
	<span class="nc">ExecutorService</span> <span class="n">threadPool</span> <span class="o">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="na">newFixedThreadPool</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
	<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">SocketClient</span><span class="o">&gt;</span> <span class="n">chatRoom</span> <span class="o">=</span> <span class="nc">Collections</span><span class="o">.</span><span class="na">synchronizedMap</span><span class="o">(</span><span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;());</span>

	<span class="c1">// 메소드: 서버 시작</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
		<span class="n">serverSocket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ServerSocket</span><span class="o">(</span><span class="mi">50001</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] 시작됨"</span><span class="o">);</span>

		<span class="nc">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
			<span class="k">try</span> <span class="o">{</span>
				<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
					<span class="nc">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="n">serverSocket</span><span class="o">.</span><span class="na">accept</span><span class="o">();</span>
					<span class="nc">SocketClient</span> <span class="n">sc</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SocketClient</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">socket</span><span class="o">);</span>
				<span class="o">}</span>
			<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="o">}</span>
		<span class="o">});</span>
		<span class="n">thread</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="c1">// 메소드: 클라이언트 연결 시 SocketClient 생성 및 추가</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">addSocketClient</span><span class="o">(</span><span class="nc">SocketClient</span> <span class="n">socketClient</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">socketClient</span><span class="o">.</span><span class="na">chatName</span> <span class="o">+</span> <span class="s">"@"</span> <span class="o">+</span> <span class="n">socketClient</span><span class="o">.</span><span class="na">clientIp</span><span class="o">;</span>
		<span class="n">chatRoom</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">socketClient</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"입장: "</span> <span class="o">+</span> <span class="n">key</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"현재 채팅자 수: "</span> <span class="o">+</span> <span class="n">chatRoom</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="c1">// 메소드: 클라이언트 연결 종료 시 SocketClient 제거</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">removeSocketClient</span><span class="o">(</span><span class="nc">SocketClient</span> <span class="n">socketClient</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">socketClient</span><span class="o">.</span><span class="na">chatName</span> <span class="o">+</span> <span class="s">"@"</span> <span class="o">+</span> <span class="n">socketClient</span><span class="o">.</span><span class="na">clientIp</span><span class="o">;</span>
		<span class="n">chatRoom</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"나감: "</span> <span class="o">+</span> <span class="n">key</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"현재 채팅자 수: "</span> <span class="o">+</span> <span class="n">chatRoom</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="c1">// 메소드: 모든 클라이언트에게 메시지 보냄</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">sendToAll</span><span class="o">(</span><span class="nc">SocketClient</span> <span class="n">sender</span><span class="o">,</span> <span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">JSONObject</span> <span class="n">root</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">();</span>
		<span class="n">root</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"clientIp"</span><span class="o">,</span> <span class="n">sender</span><span class="o">.</span><span class="na">clientIp</span><span class="o">);</span>
		<span class="n">root</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"chatName"</span><span class="o">,</span> <span class="n">sender</span><span class="o">.</span><span class="na">chatName</span><span class="o">);</span>
		<span class="n">root</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"message"</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
		<span class="nc">String</span> <span class="n">json</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>

		<span class="nc">Collection</span><span class="o">&lt;</span><span class="nc">SocketClient</span><span class="o">&gt;</span> <span class="n">socketClients</span> <span class="o">=</span> <span class="n">chatRoom</span><span class="o">.</span><span class="na">values</span><span class="o">();</span>
		<span class="k">for</span> <span class="o">(</span><span class="nc">SocketClient</span> <span class="n">sc</span> <span class="o">:</span> <span class="n">socketClients</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">sc</span> <span class="o">==</span> <span class="n">sender</span><span class="o">)</span> <span class="k">continue</span><span class="o">;</span>
			<span class="n">sc</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">json</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="c1">// 메소드: 서버 종료</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">stop</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">serverSocket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
			<span class="n">threadPool</span><span class="o">.</span><span class="na">shutdownNow</span><span class="o">();</span>
			<span class="n">chatRoom</span><span class="o">.</span><span class="na">values</span><span class="o">().</span><span class="na">stream</span><span class="o">().</span><span class="na">forEach</span><span class="o">(</span><span class="n">sc</span> <span class="o">-&gt;</span> <span class="n">sc</span><span class="o">.</span><span class="na">close</span><span class="o">());</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] 종료됨"</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e1</span><span class="o">)</span> <span class="o">{}</span>
	<span class="o">}</span>

	<span class="c1">// 메소드: 메인</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="nc">ChatServer</span> <span class="n">chatServer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ChatServer</span><span class="o">();</span>
			<span class="n">chatServer</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>

			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--------------------------------------------------------------------"</span><span class="o">);</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"서버를 종료하려면 q를 입력하고 Enter 키를 입력하세요."</span><span class="o">);</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--------------------------------------------------------------------"</span><span class="o">);</span>

			<span class="nc">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
			<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
				<span class="nc">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
				<span class="k">if</span> <span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"q"</span><span class="o">))</span> <span class="k">break</span><span class="o">;</span>
			<span class="o">}</span>
			<span class="n">scanner</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
			<span class="n">chatServer</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">ch19.sec07</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.DataInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.DataOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.InetSocketAddress</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.Socket</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.json.JSONObject</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SocketClient</span> <span class="o">{</span>
	<span class="c1">// 필드</span>
	<span class="nc">ChatServer</span> <span class="n">chatServer</span><span class="o">;</span>
	<span class="nc">Socket</span> <span class="n">socket</span><span class="o">;</span>
	<span class="nc">DataInputStream</span> <span class="n">dis</span><span class="o">;</span>
	<span class="nc">DataOutputStream</span> <span class="n">dos</span><span class="o">;</span>
	<span class="nc">String</span> <span class="n">clientIp</span><span class="o">;</span>
	<span class="nc">String</span> <span class="n">chatName</span><span class="o">;</span>

	<span class="c1">// 생성자</span>
	<span class="kd">public</span> <span class="nf">SocketClient</span><span class="o">(</span><span class="nc">ChatServer</span> <span class="n">chatServer</span><span class="o">,</span> <span class="nc">Socket</span> <span class="n">socket</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="k">this</span><span class="o">.</span><span class="na">chatServer</span> <span class="o">=</span> <span class="n">chatServer</span><span class="o">;</span>
			<span class="k">this</span><span class="o">.</span><span class="na">socket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">;</span>
			<span class="k">this</span><span class="o">.</span><span class="na">dis</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataInputStream</span><span class="o">(</span><span class="n">socket</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">());</span>
			<span class="k">this</span><span class="o">.</span><span class="na">dos</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataOutputStream</span><span class="o">(</span><span class="n">socket</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">());</span>
			<span class="nc">InetSocketAddress</span> <span class="n">isa</span> <span class="o">=</span> <span class="o">(</span><span class="nc">InetSocketAddress</span><span class="o">)</span> <span class="n">socket</span><span class="o">.</span><span class="na">getRemoteSocketAddress</span><span class="o">();</span>
			<span class="k">this</span><span class="o">.</span><span class="na">clientIp</span> <span class="o">=</span> <span class="n">isa</span><span class="o">.</span><span class="na">getHostName</span><span class="o">();</span>
			<span class="n">receive</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="c1">// 메소드: JSON 받기</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">receive</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">chatServer</span><span class="o">.</span><span class="na">threadPool</span><span class="o">.</span><span class="na">execute</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
			<span class="k">try</span> <span class="o">{</span>
				<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
					<span class="nc">String</span> <span class="n">receiveJson</span> <span class="o">=</span> <span class="n">dis</span><span class="o">.</span><span class="na">readUTF</span><span class="o">();</span>

					<span class="nc">JSONObject</span> <span class="n">jsonObject</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">(</span><span class="n">receiveJson</span><span class="o">);</span>
					<span class="nc">String</span> <span class="n">command</span> <span class="o">=</span> <span class="n">jsonObject</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"command"</span><span class="o">);</span>

					<span class="k">switch</span> <span class="o">(</span><span class="n">command</span><span class="o">)</span> <span class="o">{</span>
						<span class="k">case</span> <span class="s">"incoming"</span><span class="o">:</span>
							<span class="k">this</span><span class="o">.</span><span class="na">chatName</span> <span class="o">=</span> <span class="n">jsonObject</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"data"</span><span class="o">);</span>
							<span class="n">chatServer</span><span class="o">.</span><span class="na">sendToAll</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"들어오셨습니다."</span><span class="o">);</span>
							<span class="n">chatServer</span><span class="o">.</span><span class="na">addSocketClient</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
							<span class="k">break</span><span class="o">;</span>
						<span class="k">case</span> <span class="s">"message"</span><span class="o">:</span>
							<span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">jsonObject</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"data"</span><span class="o">);</span>
							<span class="n">chatServer</span><span class="o">.</span><span class="na">sendToAll</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
							<span class="k">break</span><span class="o">;</span>
					<span class="o">}</span>
				<span class="o">}</span>
			<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">chatServer</span><span class="o">.</span><span class="na">sendToAll</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"나가셨습니다."</span><span class="o">);</span>
				<span class="n">chatServer</span><span class="o">.</span><span class="na">removeSocketClient</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
			<span class="o">}</span>
		<span class="o">});</span>
	<span class="o">}</span>

	<span class="c1">// 메소드: JSON 보내기</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">send</span><span class="o">(</span><span class="nc">String</span> <span class="n">json</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">dos</span><span class="o">.</span><span class="na">writeUTF</span><span class="o">(</span><span class="n">json</span><span class="o">);</span>
			<span class="n">dos</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="c1">// 메소드: 연결 종료</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">close</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">socket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="채팅-클라이언트">채팅 클라이언트</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">ch19.sec07</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.DataInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.DataOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.Socket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.json.JSONObject</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ChatClient</span> <span class="o">{</span>
	<span class="c1">// 필드</span>
	<span class="nc">Socket</span> <span class="n">socket</span><span class="o">;</span>
	<span class="nc">DataInputStream</span> <span class="n">dis</span><span class="o">;</span>
	<span class="nc">DataOutputStream</span> <span class="n">dos</span><span class="o">;</span>
	<span class="nc">String</span> <span class="n">chatName</span><span class="o">;</span>

	<span class="c1">// 메소드: 서버 연결</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">connect</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
		<span class="n">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Socket</span><span class="o">(</span><span class="s">"localhost"</span><span class="o">,</span> <span class="mi">50001</span><span class="o">);</span>
		<span class="n">dis</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataInputStream</span><span class="o">(</span><span class="n">socket</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">());</span>
		<span class="n">dos</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataOutputStream</span><span class="o">(</span><span class="n">socket</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">());</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[클라이언트] 서버에 연결됨"</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="c1">// 메소드: JSON 받기</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">receive</span><span class="o">()</span> <span class="o">{</span>
		<span class="nc">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
			<span class="k">try</span> <span class="o">{</span>
				<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
					<span class="nc">String</span> <span class="n">json</span> <span class="o">=</span> <span class="n">dis</span><span class="o">.</span><span class="na">readUTF</span><span class="o">();</span>
					<span class="nc">JSONObject</span> <span class="n">root</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">(</span><span class="n">json</span><span class="o">);</span>
					<span class="nc">String</span> <span class="n">clientIp</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"clientIp"</span><span class="o">);</span>
					<span class="nc">String</span> <span class="n">chatName</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"chatName"</span><span class="o">);</span>
					<span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"message"</span><span class="o">);</span>
					<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"&lt;"</span> <span class="o">+</span> <span class="n">chatName</span> <span class="o">+</span> <span class="s">"@"</span> <span class="o">+</span> <span class="n">clientIp</span> <span class="o">+</span> <span class="s">"&gt; "</span> <span class="o">+</span> <span class="n">message</span><span class="o">);</span>
				<span class="o">}</span>
			<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e1</span><span class="o">)</span> <span class="o">{</span>
				<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[클라이언트] 서버 연결 끊김"</span><span class="o">);</span>
				<span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
			<span class="o">}</span>
		<span class="o">});</span>
		<span class="n">thread</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="c1">// 메소드: JSON 보내기</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">send</span><span class="o">(</span><span class="nc">String</span> <span class="n">json</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
		<span class="n">dos</span><span class="o">.</span><span class="na">writeUTF</span><span class="o">(</span><span class="n">json</span><span class="o">);</span>
		<span class="n">dos</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="c1">// 메소드: 서버 연결 종료</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">unconnect</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
		<span class="n">socket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="c1">// 메소드: 메인</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="nc">ChatClient</span> <span class="n">chatClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ChatClient</span><span class="o">();</span>
			<span class="n">chatClient</span><span class="o">.</span><span class="na">connect</span><span class="o">();</span>

			<span class="nc">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"대화명 입력: "</span><span class="o">);</span>
			<span class="n">chatClient</span><span class="o">.</span><span class="na">chatName</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>

			<span class="nc">JSONObject</span> <span class="n">jsonObject</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">();</span>
			<span class="n">jsonObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"command"</span><span class="o">,</span> <span class="s">"incoming"</span><span class="o">);</span>
			<span class="n">jsonObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span> <span class="n">chatClient</span><span class="o">.</span><span class="na">chatName</span><span class="o">);</span>
			<span class="nc">String</span> <span class="n">json</span> <span class="o">=</span> <span class="n">jsonObject</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
			<span class="n">chatClient</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">json</span><span class="o">);</span>

			<span class="n">chatClient</span><span class="o">.</span><span class="na">receive</span><span class="o">();</span>

			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--------------------------------------------------------------------"</span><span class="o">);</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"보낼 메시지를 입력하고 Enter"</span><span class="o">);</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"채팅를 종료하려면 q를 입력하고 Enter"</span><span class="o">);</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--------------------------------------------------------------------"</span><span class="o">);</span>

			<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
				<span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
				<span class="k">if</span> <span class="o">(</span><span class="n">message</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"q"</span><span class="o">))</span> <span class="o">{</span>
					<span class="k">break</span><span class="o">;</span>
				<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
					<span class="n">jsonObject</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">();</span>
					<span class="n">jsonObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"command"</span><span class="o">,</span> <span class="s">"message"</span><span class="o">);</span>
					<span class="n">jsonObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
					<span class="n">json</span> <span class="o">=</span> <span class="n">jsonObject</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
					<span class="n">chatClient</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">json</span><span class="o">);</span>
				<span class="o">}</span>
			<span class="o">}</span>
			<span class="n">scanner</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
			<span class="n">chatClient</span><span class="o">.</span><span class="na">unconnect</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[클라이언트] 서버 연결 안됨"</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="확인문제">확인문제</h2>

<ol>
  <li>서버와 클라이언트에 대한 설명으로 틀린 것은 무엇입니까?
    <ul>
      <li>① 서비스를 제공하는 쪽이 서버이고, 서비스를 요청하는 쪽이 클라이언트이다.</li>
      <li>② 클라이언트가 서버에 연결하기 위해서는 IP 주소만 있으면 된다.</li>
      <li>③ 포트(Port)는 여러 서버 중에 특정 서버와 연결하기 위해 필요한 정보다.</li>
      <li>④ 서버와 클라이언트는 양쪽 모두 포트가 배정되어야 한다.
        <blockquote>
          <p><strong>정답</strong>: ②
<strong>해설</strong>: IP 주소 외에도 포트 번호가 필요하다.</p>
        </blockquote>
      </li>
    </ul>
  </li>
  <li>TCP와 UDP에 대한 설명으로 틀린 것을 모두 선택하세요.
    <ul>
      <li>① TCP는 데이터 입출력에 앞서 연결 요청과 수락 과정이 필요하다.</li>
      <li>② TCP는 여러 회선으로 데이터를 전달하므로, 데이터의 전달 순서가 달라질 수 있다.</li>
      <li>③ UDP는 연결 수락 과정이 없기 때문에 TCP보다 상대적으로 빠르다.</li>
      <li>④ UDP는 고정된 회선으로 데이터를 전달하기 때문에 전달 신뢰도가 높다.
        <blockquote>
          <p><strong>정답</strong>: ②, ④
<strong>해설</strong>: TCP는 고정 회선을 사용하므로 순서가 보장된다. UDP는 고정 회선이 아니므로 데이터 순서가 달라질 수 있고 신뢰도가 낮다.</p>
        </blockquote>
      </li>
    </ul>
  </li>
  <li>다음은 TCP 클라이언트가 서버로 연결 요청을 하고 서버는 연결을 수락하는 코드이다. 빈칸에 들어갈 코드를 작성하세요. (단, 클라이언트와 서버는 같은 컴퓨터에서 실행하고 있습니다.)
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// [클라이언트]</span>
<span class="nc">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Socket</span><span class="o">(</span><span class="s">"localhost"</span><span class="o">,</span> <span class="mi">5001</span><span class="o">);</span>

<span class="c1">// [서버]</span>
<span class="nc">ServerSocket</span> <span class="n">serverSocket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ServerSocket</span><span class="o">(</span><span class="mi">5001</span><span class="o">);</span>
<span class="nc">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="n">serverSocket</span><span class="o">.</span><span class="na">accept</span><span class="o">();</span>
</code></pre></div>    </div>
  </li>
  <li>TCP를 사용하는 클라이언트를 서버에 연결해 Socket으로 데이터 입출력을 하려고 합니다. 빈칸에 Socket을 통해 얻는 입출력 스트림의 타입을 적어 보세요.
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
<span class="nc">OutputStream</span> <span class="n">os</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">();</span>
</code></pre></div>    </div>
  </li>
  <li>UDP를 사용하는 클라이언트를 서버에서 사용되는 클래스 이름 및 데이터와 수신 · 발신할 때 사용되는 클래스 이름을 ① ~ ⑤ 빈칸에 작성해 보세요.
    <ul>
      <li>① <code class="language-plaintext highlighter-rouge">DatagramPacket</code></li>
      <li>② <code class="language-plaintext highlighter-rouge">DatagramSocket</code></li>
      <li>③ <code class="language-plaintext highlighter-rouge">DatagramPacket</code></li>
      <li>④ <code class="language-plaintext highlighter-rouge">DatagramPacket</code></li>
      <li>⑤ <code class="language-plaintext highlighter-rouge">DatagramSocket</code></li>
    </ul>
  </li>
  <li>서버 측 DatagramSocket에 대한 설명으로 틀린 것은 무엇입니까?
    <ul>
      <li>① 서버에서는 고정된 Port 번호를 제공하고 생성해야 한다.</li>
      <li>② receive() 메소드는 데이터를 수신할 때까지 블로킹된다.</li>
      <li>③ 클라이언트의 IP 주소와 Port 번호는 수신된 DatagramPacket에서 얻을 수 있다.</li>
      <li>④ 클라이언트로 DatagramPacket을 발신할 때 write() 메소드를 사용한다.
        <blockquote>
          <p><strong>정답</strong>: ④
<strong>해설</strong>: <code class="language-plaintext highlighter-rouge">send()</code> 메소드를 사용한다.</p>
        </blockquote>
      </li>
    </ul>
  </li>
  <li>
    <p>상품관리 프로그램을 TCP를 이용해서 개발하려고 합니다. 다음 내용에 맞게 서버와 클라이언트를 직접 개발해 보세요.</p>

    <p><em>(문제 내용 생략)</em></p>

    <p><strong>요약</strong>: Create, Update, Delete 기능을 가진 상품 관리 서버/클라이언트 구현. JSON 통신 사용.</p>

    <p><strong>Product.java</strong></p>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">ch19.check</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">lombok.AllArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Data</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="o">;</span>

<span class="nd">@Data</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Product</span> <span class="kd">implements</span> <span class="nc">Serializable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">no</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">price</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">stock</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div>    </div>

    <p><strong>ProductServer.java</strong> (서버 구현)</p>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">ch19.check</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.DataInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.DataOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.ServerSocket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.Socket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Collections</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Vector</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.ExecutorService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Executors</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.json.JSONArray</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.JSONObject</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductServer</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">ServerSocket</span> <span class="n">serverSocket</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">ExecutorService</span> <span class="n">threadPool</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Product</span><span class="o">&gt;</span> <span class="n">products</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">sequence</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="n">serverSocket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ServerSocket</span><span class="o">(</span><span class="mi">50001</span><span class="o">);</span>
        <span class="n">threadPool</span> <span class="o">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="na">newFixedThreadPool</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
        <span class="n">products</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Vector</span><span class="o">&lt;&gt;();</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] 시작됨"</span><span class="o">);</span>

        <span class="k">while</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="n">serverSocket</span><span class="o">.</span><span class="na">accept</span><span class="o">();</span>
            <span class="nc">SocketClient</span> <span class="n">sc</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SocketClient</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">socket</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">stop</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">serverSocket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="n">threadPool</span><span class="o">.</span><span class="na">shutdownNow</span><span class="o">();</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] 종료됨"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e1</span><span class="o">)</span> <span class="o">{}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">ProductServer</span> <span class="n">productServer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ProductServer</span><span class="o">();</span>
            <span class="n">productServer</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[서버] "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="c1">// 중첩 클래스</span>
    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">SocketClient</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="nc">ProductServer</span> <span class="n">productServer</span><span class="o">;</span>
        <span class="kd">private</span> <span class="nc">Socket</span> <span class="n">socket</span><span class="o">;</span>
        <span class="kd">private</span> <span class="nc">DataInputStream</span> <span class="n">dis</span><span class="o">;</span>
        <span class="kd">private</span> <span class="nc">DataOutputStream</span> <span class="n">dos</span><span class="o">;</span>

        <span class="kd">public</span> <span class="nf">SocketClient</span><span class="o">(</span><span class="nc">ProductServer</span> <span class="n">productServer</span><span class="o">,</span> <span class="nc">Socket</span> <span class="n">socket</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="k">this</span><span class="o">.</span><span class="na">productServer</span> <span class="o">=</span> <span class="n">productServer</span><span class="o">;</span>
                <span class="k">this</span><span class="o">.</span><span class="na">socket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">;</span>
                <span class="k">this</span><span class="o">.</span><span class="na">dis</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataInputStream</span><span class="o">(</span><span class="n">socket</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">());</span>
                <span class="k">this</span><span class="o">.</span><span class="na">dos</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataOutputStream</span><span class="o">(</span><span class="n">socket</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">());</span>
                <span class="n">receive</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">close</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">receive</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">productServer</span><span class="o">.</span><span class="na">threadPool</span><span class="o">.</span><span class="na">execute</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="k">while</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nc">String</span> <span class="n">requestJson</span> <span class="o">=</span> <span class="n">dis</span><span class="o">.</span><span class="na">readUTF</span><span class="o">();</span>
                        <span class="nc">JSONObject</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">(</span><span class="n">requestJson</span><span class="o">);</span>
                        <span class="kt">int</span> <span class="n">menu</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"menu"</span><span class="o">);</span>

                        <span class="k">switch</span><span class="o">(</span><span class="n">menu</span><span class="o">)</span> <span class="o">{</span>
                            <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
                                <span class="n">list</span><span class="o">();</span>
                                <span class="k">break</span><span class="o">;</span>
                            <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
                                <span class="n">create</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
                                <span class="k">break</span><span class="o">;</span>
                            <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
                                <span class="n">update</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
                                <span class="k">break</span><span class="o">;</span>
                            <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
                                <span class="n">delete</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
                                <span class="k">break</span><span class="o">;</span>
                        <span class="o">}</span>
                    <span class="o">}</span>
                <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">close</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">});</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">list</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
            <span class="nc">JSONArray</span> <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONArray</span><span class="o">();</span>
            <span class="k">for</span><span class="o">(</span><span class="nc">Product</span> <span class="n">p</span> <span class="o">:</span> <span class="n">productServer</span><span class="o">.</span><span class="na">products</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">JSONObject</span> <span class="n">product</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">();</span>
                <span class="n">product</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"no"</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="na">getNo</span><span class="o">());</span>
                <span class="n">product</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
                <span class="n">product</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"price"</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="na">getPrice</span><span class="o">());</span>
                <span class="n">product</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"stock"</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="na">getStock</span><span class="o">());</span>
                <span class="n">data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">product</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="nc">JSONObject</span> <span class="n">response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">();</span>
            <span class="n">response</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"status"</span><span class="o">,</span> <span class="s">"success"</span><span class="o">);</span>
            <span class="n">response</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>
            <span class="n">dos</span><span class="o">.</span><span class="na">writeUTF</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
            <span class="n">dos</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">create</span><span class="o">(</span><span class="nc">JSONObject</span> <span class="n">request</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
            <span class="nc">JSONObject</span> <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="s">"data"</span><span class="o">);</span>
            <span class="nc">Product</span> <span class="n">product</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Product</span><span class="o">();</span>
            <span class="n">product</span><span class="o">.</span><span class="na">setNo</span><span class="o">(++</span><span class="n">productServer</span><span class="o">.</span><span class="na">sequence</span><span class="o">);</span>
            <span class="n">product</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"name"</span><span class="o">));</span>
            <span class="n">product</span><span class="o">.</span><span class="na">setPrice</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"price"</span><span class="o">));</span>
            <span class="n">product</span><span class="o">.</span><span class="na">setStock</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"stock"</span><span class="o">));</span>
            <span class="n">productServer</span><span class="o">.</span><span class="na">products</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">product</span><span class="o">);</span>

            <span class="n">list</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="nc">JSONObject</span> <span class="n">request</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
            <span class="nc">JSONObject</span> <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="s">"data"</span><span class="o">);</span>
            <span class="kt">int</span> <span class="n">no</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"no"</span><span class="o">);</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">productServer</span><span class="o">.</span><span class="na">products</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="nc">Product</span> <span class="n">product</span> <span class="o">=</span> <span class="n">productServer</span><span class="o">.</span><span class="na">products</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                <span class="k">if</span><span class="o">(</span><span class="n">product</span><span class="o">.</span><span class="na">getNo</span><span class="o">()</span> <span class="o">==</span> <span class="n">no</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">product</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"name"</span><span class="o">));</span>
                    <span class="n">product</span><span class="o">.</span><span class="na">setPrice</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"price"</span><span class="o">));</span>
                    <span class="n">product</span><span class="o">.</span><span class="na">setStock</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"stock"</span><span class="o">));</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="n">list</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">delete</span><span class="o">(</span><span class="nc">JSONObject</span> <span class="n">request</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        	<span class="nc">JSONObject</span> <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="s">"data"</span><span class="o">);</span>
            <span class="kt">int</span> <span class="n">no</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"no"</span><span class="o">);</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">productServer</span><span class="o">.</span><span class="na">products</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="nc">Product</span> <span class="n">product</span> <span class="o">=</span> <span class="n">productServer</span><span class="o">.</span><span class="na">products</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                <span class="k">if</span><span class="o">(</span><span class="n">product</span><span class="o">.</span><span class="na">getNo</span><span class="o">()</span> <span class="o">==</span> <span class="n">no</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">productServer</span><span class="o">.</span><span class="na">products</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="n">list</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">close</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
            	<span class="n">socket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>    </div>

    <p><strong>ProductClient.java</strong> (클라이언트 구현)</p>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">ch19.check</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.DataInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.DataOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.Socket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.json.JSONArray</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.JSONObject</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductClient</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Socket</span> <span class="n">socket</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">DataInputStream</span> <span class="n">dis</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">DataOutputStream</span> <span class="n">dos</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Scanner</span> <span class="n">scanner</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="n">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Socket</span><span class="o">(</span><span class="s">"localhost"</span><span class="o">,</span> <span class="mi">50001</span><span class="o">);</span>
        <span class="n">dis</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataInputStream</span><span class="o">(</span><span class="n">socket</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">());</span>
        <span class="n">dos</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataOutputStream</span><span class="o">(</span><span class="n">socket</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">());</span>
        <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
            
        <span class="n">list</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">stop</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">socket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="n">scanner</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[클라이언트] 종료"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">list</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"\n[상품 목록]"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--------------------------------------------------"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"no\tname\t\tprice\tstock"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--------------------------------------------------"</span><span class="o">);</span>
            
        <span class="c1">// 서버에 목록 요청</span>
        <span class="nc">JSONObject</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">();</span>
        <span class="n">request</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"menu"</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
        <span class="n">request</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">());</span>
        <span class="n">dos</span><span class="o">.</span><span class="na">writeUTF</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="n">dos</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
            
        <span class="c1">// 응답 받기</span>
        <span class="nc">String</span> <span class="n">responseJson</span> <span class="o">=</span> <span class="n">dis</span><span class="o">.</span><span class="na">readUTF</span><span class="o">();</span>
        <span class="nc">JSONObject</span> <span class="n">response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">(</span><span class="n">responseJson</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"status"</span><span class="o">).</span><span class="na">equals</span><span class="o">(</span><span class="s">"success"</span><span class="o">))</span> <span class="o">{</span>
        	<span class="nc">JSONArray</span> <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getJSONArray</span><span class="o">(</span><span class="s">"data"</span><span class="o">);</span>
        	<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        		<span class="nc">JSONObject</span> <span class="n">product</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span>
        			<span class="n">product</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"no"</span><span class="o">)</span> <span class="o">+</span> <span class="s">"\t"</span> <span class="o">+</span> 
        			<span class="n">product</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"name"</span><span class="o">)</span> <span class="o">+</span> <span class="s">"\t"</span> <span class="o">+</span> 
        			<span class="n">product</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"price"</span><span class="o">)</span> <span class="o">+</span> <span class="s">"\t"</span> <span class="o">+</span> 
        			<span class="n">product</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"stock"</span><span class="o">)</span>
        		<span class="o">);</span>
        	<span class="o">}</span>
        <span class="o">}</span>
            
        <span class="n">menu</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">menu</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--------------------------------------------------"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"메뉴: 1.Create | 2.Update | 3.Delete | 4.Exit"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"선택: "</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">menuNo</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
        <span class="k">switch</span><span class="o">(</span><span class="n">menuNo</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">case</span> <span class="s">"1"</span><span class="o">:</span> <span class="n">create</span><span class="o">();</span> <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="s">"2"</span><span class="o">:</span> <span class="n">update</span><span class="o">();</span> <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="s">"3"</span><span class="o">:</span> <span class="n">delete</span><span class="o">();</span> <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="s">"4"</span><span class="o">:</span> <span class="n">stop</span><span class="o">();</span> <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">create</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[상품 생성]"</span><span class="o">);</span>
        <span class="nc">Product</span> <span class="n">product</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Product</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"상품 이름: "</span><span class="o">);</span>
        <span class="n">product</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"상품 가격: "</span><span class="o">);</span>
        <span class="n">product</span><span class="o">.</span><span class="na">setPrice</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">()));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"상품 재고: "</span><span class="o">);</span>
        <span class="n">product</span><span class="o">.</span><span class="na">setStock</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">()));</span>

        <span class="nc">JSONObject</span> <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">();</span>
        <span class="n">data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="n">product</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"price"</span><span class="o">,</span> <span class="n">product</span><span class="o">.</span><span class="na">getPrice</span><span class="o">());</span>
        <span class="n">data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"stock"</span><span class="o">,</span> <span class="n">product</span><span class="o">.</span><span class="na">getStock</span><span class="o">());</span>

        <span class="nc">JSONObject</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">();</span>
        <span class="n">request</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"menu"</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
        <span class="n">request</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>

        <span class="n">dos</span><span class="o">.</span><span class="na">writeUTF</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="n">dos</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
            
        <span class="c1">// 응답 대기 및 목록 갱신</span>
        <span class="nc">String</span> <span class="n">responseJson</span> <span class="o">=</span> <span class="n">dis</span><span class="o">.</span><span class="na">readUTF</span><span class="o">();</span>
        <span class="nc">JSONObject</span> <span class="n">response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">(</span><span class="n">responseJson</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"status"</span><span class="o">).</span><span class="na">equals</span><span class="o">(</span><span class="s">"success"</span><span class="o">))</span> <span class="o">{</span>
        	<span class="n">list</span><span class="o">();</span>   
        <span class="o">}</span>
    <span class="o">}</span>
        
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[상품 수정]"</span><span class="o">);</span>
        <span class="nc">Product</span> <span class="n">product</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Product</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"상품 번호: "</span><span class="o">);</span>
        <span class="n">product</span><span class="o">.</span><span class="na">setNo</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">()));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"이름 변경: "</span><span class="o">);</span>
        <span class="n">product</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"가격 변경: "</span><span class="o">);</span>
        <span class="n">product</span><span class="o">.</span><span class="na">setPrice</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">()));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"재고 변경: "</span><span class="o">);</span>
        <span class="n">product</span><span class="o">.</span><span class="na">setStock</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">()));</span>

        <span class="nc">JSONObject</span> <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">();</span>
        <span class="n">data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"no"</span><span class="o">,</span> <span class="n">product</span><span class="o">.</span><span class="na">getNo</span><span class="o">());</span>
        <span class="n">data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="n">product</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"price"</span><span class="o">,</span> <span class="n">product</span><span class="o">.</span><span class="na">getPrice</span><span class="o">());</span>
        <span class="n">data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"stock"</span><span class="o">,</span> <span class="n">product</span><span class="o">.</span><span class="na">getStock</span><span class="o">());</span>

        <span class="nc">JSONObject</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">();</span>
        <span class="n">request</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"menu"</span><span class="o">,</span> <span class="mi">2</span><span class="o">);</span>
        <span class="n">request</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>

        <span class="n">dos</span><span class="o">.</span><span class="na">writeUTF</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="n">dos</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>

        <span class="c1">// 응답 대기 및 목록 갱신</span>
        <span class="nc">String</span> <span class="n">responseJson</span> <span class="o">=</span> <span class="n">dis</span><span class="o">.</span><span class="na">readUTF</span><span class="o">();</span>
        <span class="nc">JSONObject</span> <span class="n">response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">(</span><span class="n">responseJson</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"status"</span><span class="o">).</span><span class="na">equals</span><span class="o">(</span><span class="s">"success"</span><span class="o">))</span> <span class="o">{</span>
        	<span class="n">list</span><span class="o">();</span>   
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">delete</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[상품 삭제]"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"상품 번호: "</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">no</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">());</span>

        <span class="nc">JSONObject</span> <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">();</span>
        <span class="n">data</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"no"</span><span class="o">,</span> <span class="n">no</span><span class="o">);</span>

        <span class="nc">JSONObject</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">();</span>
        <span class="n">request</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"menu"</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
        <span class="n">request</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>

        <span class="n">dos</span><span class="o">.</span><span class="na">writeUTF</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="n">dos</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>

        <span class="c1">// 응답 대기 및 목록 갱신</span>
        <span class="nc">String</span> <span class="n">responseJson</span> <span class="o">=</span> <span class="n">dis</span><span class="o">.</span><span class="na">readUTF</span><span class="o">();</span>
        <span class="nc">JSONObject</span> <span class="n">response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">(</span><span class="n">responseJson</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"status"</span><span class="o">).</span><span class="na">equals</span><span class="o">(</span><span class="s">"success"</span><span class="o">))</span> <span class="o">{</span>
        	<span class="n">list</span><span class="o">();</span>   
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">ProductClient</span> <span class="n">productClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ProductClient</span><span class="o">();</span>
            <span class="n">productClient</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        	<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[클라이언트] 서버 연결 안됨"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ol>

        </div>

        <div class="bd-toc mt-3 mb-5 my-lg-0 ps-xl-3 mb-lg-5 text-body-secondary">

  <button class="btn btn-link p-md-0 mb-2 mb-md-0 text-decoration-none bd-toc-toggle d-md-none" type="button"
    data-bs-toggle="collapse" data-bs-target="#tocContents" aria-expanded="false" aria-controls="tocContents">
    서브목차
    <svg class="bi d-md-none ms-2" aria-hidden="true">
      <use xlink:href="#chevron-expand"></use>
    </svg>
  </button>

  <strong class="d-none d-md-block h6 my-2">서브목차</strong>

  <div class="collapse bd-toc-collapse" id="tocContents">
    <nav id="TableOfContents">
      <!--
      <ul>
        <li><a href="#quick-start">Quick start</a></li>
        <li><a href="#cdn-links">CDN links</a></li>
        <li><a href="#next-steps">Next steps</a></li>
        <li><a href="#js-components">JS components</a></li>
        <li><a href="#important-globals">Important globals</a>
          <ul>
            <li><a href="#html5-doctype">HTML5 doctype</a></li>
            <li><a href="#responsive-meta-tag">Responsive meta tag</a></li>
            <li><a href="#box-sizing">Box-sizing</a></li>
            <li><a href="#reboot">Reboot</a></li>
          </ul>
        </li>
        <li><a href="#community">Community</a></li>
      </ul>
      -->
    </nav>
  </div>
</div>
    </main>
</div>

  <footer class="container">
  <hr class="mt-5 mb-3">
  <div class="row align-items-center pb-3">
    <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
      <p class="mb-0 text-secondary">Copyright 2017~2026 JinyDev. All Rights Reserved.</p>
    </div>
    <div class="col-md-6 text-center text-md-end">
      
      <a href="https://datas.jiny.dev" class="text-decoration-none text-secondary ms-3">빅데이터</a>
      
      <a href="https://mysql.jiny.dev" class="text-decoration-none text-secondary ms-3">MySQL</a>
      
      <a href="https://php.jiny.dev" class="text-decoration-none text-secondary ms-3">PHP</a>
      
      <a href="https://java.jiny.dev" class="text-decoration-none text-secondary ms-3">자바</a>
      
      <a href="https://git.jiny.dev" class="text-decoration-none text-secondary ms-3">깃&깃허브</a>
      
      <a href="https://linux.jiny.dev" class="text-decoration-none text-secondary ms-3">리눅스</a>
      
    </div>
  </div>
</footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
    crossorigin="anonymous"></script>
  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';

    window.addEventListener('load', async function () {
      mermaid.initialize({ startOnLoad: false });

      const mermaidCodes = document.querySelectorAll('pre code.language-mermaid');
      const mermaidDivs = [];

      mermaidCodes.forEach(codeBlock => {
        const mermaidDefinition = codeBlock.textContent.trim();
        const container = codeBlock.closest('div.highlighter-rouge');

        const mermaidDiv = document.createElement('div');
        mermaidDiv.className = 'mermaid';
        mermaidDiv.textContent = mermaidDefinition;

        if (container) {
          container.replaceWith(mermaidDiv);
        } else {
          const pre = codeBlock.parentElement;
          if (pre) pre.replaceWith(mermaidDiv);
        }
        mermaidDivs.push(mermaidDiv);
      });

      if (mermaidDivs.length > 0) {
        await mermaid.run({ nodes: mermaidDivs });
      }
    });
  </script>
  <script src="/assets/js/toc.js"></script>

</body>

</html>